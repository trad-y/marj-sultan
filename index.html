<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ÿ±ŸàŸÜ - ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑŸÖÿ±ÿßÿ≥ŸÑÿ© ÿßŸÑŸÖÿ±ŸÉÿ≤Ÿä</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üí¨</text></svg>">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    
    <style>
        /* Reset & Base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        :root {
            --primary-color: #0084ff;
            --primary-dark: #0066cc;
            --secondary-color: #5c6bc0;
            --danger-color: #ff4444;
            --success-color: #00c851;
            --warning-color: #ffbb33;
            --bg-color: #ffffff;
            --bg-secondary: #f0f2f5;
            --text-primary: #050505;
            --text-secondary: #65676b;
            --border-color: #e4e6eb;
            --message-sent: #0084ff;
            --message-received: #e4e6eb;
            --online-status: #31a24c;
            --offline-status: #a0a0a0;
            --story-active: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888);
            --story-inactive: #e4e6eb;
            --shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 4px 12px rgba(0, 0, 0, 0.15);
            --radius: 16px;
            --radius-sm: 10px;
            --radius-xs: 8px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* Dark Theme */
        .dark-mode {
            --primary-color: #2d88ff;
            --primary-dark: #1a6ed8;
            --bg-color: #1a1a1a;
            --bg-secondary: #242526;
            --text-primary: #e4e6eb;
            --text-secondary: #b0b3b8;
            --border-color: #3e4042;
            --message-sent: #0084ff;
            --message-received: #3e4042;
            --story-inactive: #3e4042;
        }
        
        body {
            font-family: 'Cairo', sans-serif;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
            position: fixed;
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            left: 0;
            right: 0;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            transition: var(--transition);
        }
        
        /* App Container */
        #app {
            height: 100vh;
            display: flex;
            flex-direction: column;
            background-color: var(--bg-color);
            position: relative;
            transition: var(--transition);
        }
        
        /* Screens */
        .screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-color);
            transition: transform 0.3s ease;
            z-index: 10;
        }
        
        .screen.hidden {
            transform: translateX(100%);
        }
        
        .screen.active {
            transform: translateX(0);
        }
        
        /* Loading Screen */
        #loadingScreen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            z-index: 1000;
        }
        
        .loading-logo {
            font-size: 48px;
            margin-bottom: 20px;
            font-weight: 700;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 20px;
        }
        
        /* Auth Screens */
        .auth-header {
            text-align: center;
            padding: 40px 20px 30px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 0 0 30px 30px;
        }
        
        .auth-logo {
            font-size: 42px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .auth-subtitle {
            font-size: 16px;
            opacity: 0.9;
        }
        
        .auth-form {
            padding: 30px 20px;
        }
        
        .input-group {
            margin-bottom: 20px;
            position: relative;
        }
        
        .input-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .input-group input,
        .input-group select {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-sm);
            font-size: 16px;
            font-family: 'Cairo', sans-serif;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            transition: var(--transition);
        }
        
        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 132, 255, 0.1);
            background-color: var(--bg-color);
        }
        
        .input-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            padding: 16px;
            width: 100%;
            font-size: 16px;
            font-weight: 600;
            font-family: 'Cairo', sans-serif;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
        }
        
        .btn-secondary {
            background-color: transparent;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            border-radius: var(--radius-sm);
            padding: 16px;
            width: 100%;
            font-size: 16px;
            font-weight: 600;
            font-family: 'Cairo', sans-serif;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .btn-secondary:hover {
            background-color: rgba(0, 132, 255, 0.05);
        }
        
        .auth-link {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 600;
            margin-top: 20px;
            display: inline-block;
            text-align: center;
            width: 100%;
        }
        
        /* Main App Header */
        .app-header {
            background-color: var(--bg-color);
            padding: 12px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
            box-shadow: var(--shadow);
            z-index: 10;
            position: sticky;
            top: 0;
        }
        
        .header-left, .header-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .app-logo {
            font-size: 24px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .header-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .header-icon:hover {
            background-color: var(--border-color);
        }
        
        .profile-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            overflow: hidden;
            cursor: pointer;
        }
        
        .profile-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        /* Stories Section */
        .stories-container {
            padding: 16px 16px 8px;
            background-color: var(--bg-color);
            border-bottom: 1px solid var(--border-color);
            overflow-x: auto;
            white-space: nowrap;
            scrollbar-width: none;
        }
        
        .stories-container::-webkit-scrollbar {
            display: none;
        }
        
        .stories-list {
            display: flex;
            gap: 12px;
        }
        
        .story-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 70px;
            cursor: pointer;
        }
        
        .story-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            padding: 3px;
            background: var(--story-inactive);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 6px;
            transition: var(--transition);
        }
        
        .story-avatar.active {
            background: var(--story-active);
        }
        
        .story-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--bg-color);
        }
        
        .story-name {
            font-size: 12px;
            color: var(--text-secondary);
            max-width: 70px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        /* Chats List */
        .content-area {
            flex: 1;
            overflow-y: auto;
            padding-bottom: 80px;
            background-color: var(--bg-color);
        }
        
        .chat-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            gap: 12px;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 1px solid var(--border-color);
        }
        
        .chat-item:hover, .chat-item.active {
            background-color: var(--bg-secondary);
        }
        
        .chat-avatar {
            position: relative;
        }
        
        .chat-img {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            object-fit: cover;
        }
        
        .online-status {
            position: absolute;
            bottom: 2px;
            right: 2px;
            width: 14px;
            height: 14px;
            background-color: var(--online-status);
            border-radius: 50%;
            border: 2px solid var(--bg-color);
        }
        
        .online-status.offline {
            background-color: var(--offline-status);
        }
        
        .chat-info {
            flex: 1;
            min-width: 0;
        }
        
        .chat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }
        
        .chat-name {
            font-weight: 600;
            font-size: 16px;
            color: var(--text-primary);
        }
        
        .chat-time {
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        .chat-preview {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .chat-message {
            font-size: 14px;
            color: var(--text-secondary);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            flex: 1;
        }
        
        .unread-count {
            background-color: var(--primary-color);
            color: white;
            font-size: 12px;
            min-width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }
        
        /* Chat Screen */
        .chat-header {
            background-color: var(--bg-color);
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 1px solid var(--border-color);
            box-shadow: var(--shadow);
        }
        
        .back-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .back-btn:hover {
            background-color: var(--border-color);
        }
        
        .chat-header-info {
            flex: 1;
        }
        
        .chat-header-name {
            font-weight: 600;
            font-size: 16px;
        }
        
        .chat-header-status {
            font-size: 13px;
            color: var(--text-secondary);
        }
        
        .chat-messages {
            flex: 1;
            padding: 16px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
            background-color: var(--bg-secondary);
        }
        
        .message {
            display: flex;
            max-width: 80%;
            animation: fadeIn 0.3s ease;
        }
        
        .message.sent {
            align-self: flex-end;
            flex-direction: row-reverse;
        }
        
        .message.received {
            align-self: flex-start;
        }
        
        .message-bubble {
            padding: 12px 16px;
            border-radius: var(--radius);
            position: relative;
            word-wrap: break-word;
            max-width: 100%;
        }
        
        .message.sent .message-bubble {
            background-color: var(--message-sent);
            color: white;
            border-bottom-right-radius: var(--radius-xs);
        }
        
        .message.received .message-bubble {
            background-color: var(--message-received);
            color: var(--text-primary);
            border-bottom-left-radius: var(--radius-xs);
        }
        
        .message-time {
            font-size: 11px;
            margin-top: 4px;
            text-align: right;
        }
        
        .message.received .message-time {
            color: rgba(0, 0, 0, 0.5);
        }
        
        .dark-mode .message.received .message-time {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .message.sent .message-time {
            color: rgba(255, 255, 255, 0.8);
        }
        
        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            object-fit: cover;
            align-self: flex-end;
            margin: 0 8px;
        }
        
        .chat-input-container {
            padding: 12px 16px;
            background-color: var(--bg-color);
            border-top: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .message-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid var(--border-color);
            border-radius: 24px;
            font-size: 16px;
            font-family: 'Cairo', sans-serif;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            transition: var(--transition);
            resize: none;
            max-height: 120px;
            min-height: 48px;
            line-height: 1.4;
        }
        
        .message-input:focus {
            outline: none;
            border-color: var(--primary-color);
            background-color: var(--bg-color);
        }
        
        .send-btn {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: none;
            transition: var(--transition);
        }
        
        .send-btn:hover:not(:disabled) {
            background-color: var(--primary-dark);
        }
        
        .send-btn:disabled {
            background-color: var(--border-color);
            cursor: not-allowed;
        }
        
        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: var(--bg-color);
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            z-index: 50;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            color: var(--text-secondary);
            transition: var(--transition);
            flex: 1;
            padding: 8px 0;
        }
        
        .nav-item.active {
            color: var(--primary-color);
        }
        
        .nav-icon {
            font-size: 22px;
        }
        
        .nav-label {
            font-size: 11px;
            font-weight: 500;
        }
        
        /* Profile Screen */
        .profile-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 60px 20px 30px;
            text-align: center;
            position: relative;
        }
        
        .profile-back-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .profile-back-btn:hover {
            background-color: rgba(255, 255, 255, 0.3);
        }
        
        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 5px solid rgba(255, 255, 255, 0.3);
            margin-bottom: 16px;
            cursor: pointer;
        }
        
        .profile-name {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
        }
        
        .profile-status {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .profile-info {
            padding: 24px 20px;
        }
        
        .info-item {
            display: flex;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
        }
        
        .info-item:last-child {
            border-bottom: none;
        }
        
        .info-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--bg-secondary);
            color: var(--primary-color);
            margin-left: 16px;
        }
        
        .info-content {
            flex: 1;
        }
        
        .info-title {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 4px;
        }
        
        .info-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
        }
        
        .logout-btn {
            margin: 30px 20px;
            background-color: var(--danger-color);
            color: white;
        }
        
        /* Calls Screen */
        .calls-list {
            padding: 16px;
        }
        
        .call-item {
            display: flex;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
        }
        
        .call-avatar {
            position: relative;
            margin-left: 16px;
        }
        
        .call-img {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            object-fit: cover;
        }
        
        .call-info {
            flex: 1;
        }
        
        .call-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }
        
        .call-name {
            font-weight: 600;
            font-size: 16px;
        }
        
        .call-time {
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        .call-details {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .call-type {
            font-size: 14px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .call-type.incoming {
            color: var(--success-color);
        }
        
        .call-type.outgoing {
            color: var(--primary-color);
        }
        
        .call-type.missed {
            color: var(--danger-color);
        }
        
        .call-actions {
            display: flex;
            gap: 12px;
        }
        
        /* Contacts Screen */
        .contacts-container {
            padding: 16px;
        }
        
        .contact-item {
            display: flex;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
        }
        
        .contact-avatar {
            margin-left: 16px;
        }
        
        .contact-img {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            object-fit: cover;
        }
        
        .contact-info {
            flex: 1;
        }
        
        .contact-name {
            font-weight: 600;
            font-size: 16px;
        }
        
        .contact-status {
            font-size: 14px;
            color: var(--text-secondary);
        }
        
        /* Status Screen */
        .status-container {
            padding: 16px;
        }
        
        .my-status {
            display: flex;
            align-items: center;
            padding: 16px;
            background-color: var(--bg-secondary);
            border-radius: var(--radius);
            margin-bottom: 20px;
        }
        
        .status-avatar {
            margin-left: 16px;
            position: relative;
        }
        
        .status-img {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--primary-color);
        }
        
        .add-status {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 24px;
            height: 24px;
            background-color: var(--primary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            border: 2px solid var(--bg-color);
        }
        
        .status-info {
            flex: 1;
        }
        
        .status-title {
            font-weight: 600;
            font-size: 18px;
        }
        
        .status-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
        }
        
        .recent-statuses {
            margin-top: 20px;
        }
        
        .section-title {
            font-weight: 600;
            font-size: 18px;
            margin-bottom: 16px;
            color: var(--text-primary);
        }
        
        /* Settings Screen */
        .settings-container {
            padding: 16px;
        }
        
        .settings-item {
            display: flex;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
        }
        
        .settings-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--bg-secondary);
            color: var(--primary-color);
            margin-left: 16px;
        }
        
        .settings-content {
            flex: 1;
        }
        
        .settings-title {
            font-weight: 600;
            font-size: 16px;
        }
        
        .settings-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
        }
        
        .toggle-switch {
            position: relative;
            width: 50px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: var(--primary-color);
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }
        
        /* New Chat Screen */
        .new-chat-container {
            padding: 16px;
        }
        
        .search-box {
            margin-bottom: 20px;
        }
        
        .search-input {
            width: 100%;
            padding: 14px 16px 14px 48px;
            border: 2px solid var(--border-color);
            border-radius: var(--radius);
            font-size: 16px;
            font-family: 'Cairo', sans-serif;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
        }
        
        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }
        
        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        
        .modal-overlay.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .modal {
            background-color: var(--bg-color);
            border-radius: var(--radius);
            width: 90%;
            max-width: 400px;
            max-height: 80vh;
            overflow-y: auto;
            transform: translateY(20px);
            transition: transform 0.3s ease;
            box-shadow: var(--shadow-lg);
        }
        
        .modal-overlay.active .modal {
            transform: translateY(0);
        }
        
        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 20px;
            font-weight: 600;
        }
        
        .modal-close {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            cursor: pointer;
        }
        
        .modal-body {
            padding: 20px;
        }
        
        /* Call Screen */
        .call-screen {
            background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
            color: white;
        }
        
        .call-header {
            padding: 40px 20px;
            text-align: center;
            background: transparent;
            border-bottom: none;
            box-shadow: none;
        }
        
        .caller-avatar {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            margin: 0 auto 20px;
            border: 5px solid rgba(255, 255, 255, 0.1);
        }
        
        .caller-name {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .call-status {
            font-size: 18px;
            color: #aaa;
        }
        
        .call-timer {
            font-size: 48px;
            font-weight: 300;
            text-align: center;
            margin: 40px 0;
        }
        
        .call-controls {
            display: flex;
            justify-content: center;
            gap: 30px;
            padding: 40px 20px;
        }
        
        .call-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--danger-color);
            color: white;
            font-size: 24px;
            cursor: pointer;
            border: none;
            transition: var(--transition);
        }
        
        .call-btn.accept {
            background-color: var(--success-color);
        }
        
        .call-btn.speaker {
            background-color: #555;
        }
        
        .call-btn.mute {
            background-color: #555;
        }
        
        /* New Story Screen */
        .new-story-container {
            padding: 20px;
            text-align: center;
        }
        
        .story-camera {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background-color: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 30px;
            font-size: 48px;
            color: var(--text-secondary);
            border: 3px dashed var(--border-color);
            cursor: pointer;
        }
        
        .story-options {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }
        
        .story-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }
        
        .story-option-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: var(--primary-color);
        }
        
        /* Animations */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        /* Responsive */
        @media (max-width: 500px) {
            body {
                max-width: 100%;
            }
            
            .bottom-nav {
                max-width: 100%;
            }
        }
        
        /* Utility Classes */
        .hidden {
            display: none !important;
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease;
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        .text-center {
            text-align: center;
        }
        
        .mb-20 {
            margin-bottom: 20px;
        }
        
        .mt-20 {
            margin-top: 20px;
        }
        
        .d-flex {
            display: flex;
        }
        
        .align-center {
            align-items: center;
        }
        
        .justify-between {
            justify-content: space-between;
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- Loading Screen -->
        <div id="loadingScreen" class="screen active">
            <div class="loading-logo">ÿ±ŸàŸÜ</div>
            <div class="loading-spinner"></div>
            <div>ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ...</div>
        </div>
        
        <!-- Auth Screens -->
        <div id="authScreen" class="screen hidden">
            <div class="auth-header">
                <div class="auth-logo">ÿ±ŸàŸÜ</div>
                <div class="auth-subtitle">ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑŸÖÿ±ÿßÿ≥ŸÑÿ© ÿßŸÑŸÖÿ±ŸÉÿ≤Ÿä</div>
            </div>
            
            <div class="auth-form">
                <div id="loginForm">
                    <div class="input-group">
                        <label class="input-label">ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ£Ÿà ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä</label>
                        <input type="text" id="loginUsername" placeholder="ÿ£ÿØÿÆŸÑ ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ£Ÿà ÿßŸÑÿ®ÿ±ŸäÿØ">
                        <div class="input-icon">
                            <i class="fas fa-user"></i>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±</label>
                        <input type="password" id="loginPassword" placeholder="ÿ£ÿØÿÆŸÑ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±">
                        <div class="input-icon">
                            <i class="fas fa-lock"></i>
                        </div>
                    </div>
                    
                    <button class="btn-primary" id="loginBtn">
                        <i class="fas fa-sign-in-alt"></i>
                        ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ
                    </button>
                    
                    <div class="text-center mt-20">
                        <span>ŸÑŸäÿ≥ ŸÑÿØŸäŸÉ ÿ≠ÿ≥ÿßÿ®ÿü </span>
                        <a href="#" class="auth-link" id="showRegisterBtn">ÿ•ŸÜÿ¥ÿßÿ° ÿ≠ÿ≥ÿßÿ® ÿ¨ÿØŸäÿØ</a>
                    </div>
                </div>
                
                <div id="registerForm" class="hidden">
                    <div class="input-group">
                        <label class="input-label">ÿßŸÑÿßÿ≥ŸÖ ÿßŸÑŸÉÿßŸÖŸÑ</label>
                        <input type="text" id="registerName" placeholder="ÿ£ÿØÿÆŸÑ ÿßÿ≥ŸÖŸÉ ÿßŸÑŸÉÿßŸÖŸÑ">
                        <div class="input-icon">
                            <i class="fas fa-user"></i>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ</label>
                        <input type="text" id="registerUsername" placeholder="ÿßÿÆÿ™ÿ± ÿßÿ≥ŸÖ ŸÖÿ≥ÿ™ÿÆÿØŸÖ">
                        <div class="input-icon">
                            <i class="fas fa-at"></i>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä</label>
                        <input type="email" id="registerEmail" placeholder="ÿ£ÿØÿÆŸÑ ÿ®ÿ±ŸäÿØŸÉ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä">
                        <div class="input-icon">
                            <i class="fas fa-envelope"></i>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±</label>
                        <input type="password" id="registerPassword" placeholder="ÿßÿÆÿ™ÿ± ŸÉŸÑŸÖÿ© ŸÖÿ±Ÿàÿ± ŸÇŸàŸäÿ©">
                        <div class="input-icon">
                            <i class="fas fa-lock"></i>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">ÿ™ÿ£ŸÉŸäÿØ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±</label>
                        <input type="password" id="registerConfirmPassword" placeholder="ÿ£ÿπÿØ ÿ•ÿØÿÆÿßŸÑ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±">
                        <div class="input-icon">
                            <i class="fas fa-lock"></i>
                        </div>
                    </div>
                    
                    <button class="btn-primary" id="registerBtn">
                        <i class="fas fa-user-plus"></i>
                        ÿ•ŸÜÿ¥ÿßÿ° ÿ≠ÿ≥ÿßÿ®
                    </button>
                    
                    <div class="text-center mt-20">
                        <span>ŸÑÿØŸäŸÉ ÿ≠ÿ≥ÿßÿ® ÿ®ÿßŸÑŸÅÿπŸÑÿü </span>
                        <a href="#" class="auth-link" id="showLoginBtn">ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ</a>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Main App Screen -->
        <div id="mainScreen" class="screen hidden">
            <!-- Header -->
            <div class="app-header">
                <div class="header-left">
                    <div class="app-logo">ÿ±ŸàŸÜ</div>
                </div>
                
                <div class="header-right">
                    <div class="header-icon" id="themeToggle">
                        <i class="fas fa-moon"></i>
                    </div>
                    <div class="header-icon" id="searchBtn">
                        <i class="fas fa-search"></i>
                    </div>
                    <div class="header-icon" id="newChatBtn">
                        <i class="fas fa-edit"></i>
                    </div>
                    <div class="profile-btn" id="profileBtn">
                        <img id="headerProfileImg" src="https://randomuser.me/api/portraits/men/32.jpg" alt="ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä" class="profile-img">
                    </div>
                </div>
            </div>
            
            <!-- Content Area (Dynamic based on navigation) -->
            <div class="content-area" id="contentArea">
                <!-- Content will be loaded dynamically -->
            </div>
            
            <!-- Bottom Navigation -->
            <div class="bottom-nav">
                <div class="nav-item active" data-page="chats">
                    <div class="nav-icon">
                        <i class="fas fa-comments"></i>
                    </div>
                    <div class="nav-label">ÿßŸÑÿØÿ±ÿØÿ¥ÿßÿ™</div>
                </div>
                
                <div class="nav-item" data-page="calls">
                    <div class="nav-icon">
                        <i class="fas fa-phone"></i>
                    </div>
                    <div class="nav-label">ÿßŸÑŸÖŸÉÿßŸÑŸÖÿßÿ™</div>
                </div>
                
                <div class="nav-item" data-page="contacts">
                    <div class="nav-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="nav-label">ÿ¨Ÿáÿßÿ™ ÿßŸÑÿßÿ™ÿµÿßŸÑ</div>
                </div>
                
                <div class="nav-item" data-page="status">
                    <div class="nav-icon">
                        <i class="fas fa-circle"></i>
                    </div>
                    <div class="nav-label">ÿßŸÑÿ≠ÿßŸÑÿ©</div>
                </div>
                
                <div class="nav-item" data-page="settings">
                    <div class="nav-icon">
                        <i class="fas fa-cog"></i>
                    </div>
                    <div class="nav-label">ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™</div>
                </div>
            </div>
        </div>
        
        <!-- Chat Screen -->
        <div id="chatScreen" class="screen hidden">
            <div class="chat-header">
                <div class="back-btn" id="backFromChatBtn">
                    <i class="fas fa-arrow-right"></i>
                </div>
                
                <div class="chat-avatar">
                    <img id="chatUserImg" src="" alt="ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ" class="chat-img">
                    <div class="online-status" id="chatUserStatus"></div>
                </div>
                
                <div class="chat-header-info">
                    <div class="chat-header-name" id="chatUserName"></div>
                    <div class="chat-header-status" id="chatUserStatusText"></div>
                </div>
                
                <div class="header-icon" id="audioCallBtn">
                    <i class="fas fa-phone"></i>
                </div>
                
                <div class="header-icon" id="videoCallBtn">
                    <i class="fas fa-video"></i>
                </div>
                
                <div class="header-icon" id="chatMenuBtn">
                    <i class="fas fa-ellipsis-v"></i>
                </div>
            </div>
            
            <div class="chat-messages" id="chatMessages">
                <!-- Messages will be loaded here -->
            </div>
            
            <div class="chat-input-container">
                <div class="header-icon" id="attachBtn">
                    <i class="fas fa-plus"></i>
                </div>
                
                <div class="header-icon" id="cameraBtn">
                    <i class="fas fa-camera"></i>
                </div>
                
                <textarea class="message-input" id="messageInput" placeholder="ÿßŸÉÿ™ÿ® ÿ±ÿ≥ÿßŸÑÿ©..." rows="1"></textarea>
                
                <button class="send-btn" id="sendMessageBtn">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
        
        <!-- Profile Screen -->
        <div id="profileScreen" class="screen hidden">
            <div class="profile-header">
                <div class="profile-back-btn" id="backFromProfileBtn">
                    <i class="fas fa-arrow-right"></i>
                </div>
                
                <img id="profileAvatar" src="" alt="ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä" class="profile-avatar">
                
                <div class="profile-name" id="profileName"></div>
                <div class="profile-status" id="profileStatus"></div>
            </div>
            
            <div class="profile-info">
                <div class="info-item" id="editProfileBtn">
                    <div class="info-icon">
                        <i class="fas fa-user-edit"></i>
                    </div>
                    <div class="info-content">
                        <div class="info-title">ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä</div>
                        <div class="info-subtitle">ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿßÿ≥ŸÖÿå ÿßŸÑÿµŸàÿ±ÿ©ÿå ŸàÿßŸÑÿ≠ÿßŸÑÿ©</div>
                    </div>
                </div>
                
                <div class="info-item" id="notificationsSettingsBtn">
                    <div class="info-icon">
                        <i class="fas fa-bell"></i>
                    </div>
                    <div class="info-content">
                        <div class="info-title">ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™</div>
                        <div class="info-subtitle">ÿ•ÿØÿßÿ±ÿ© ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ</div>
                    </div>
                </div>
                
                <div class="info-item" id="privacySettingsBtn">
                    <div class="info-icon">
                        <i class="fas fa-lock"></i>
                    </div>
                    <div class="info-content">
                        <div class="info-title">ÿßŸÑÿÆÿµŸàÿµŸäÿ© ŸàÿßŸÑÿ£ŸÖÿßŸÜ</div>
                        <div class="info-subtitle">ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿÆÿµŸàÿµŸäÿ© ŸàÿßŸÑÿ£ŸÖÿßŸÜ</div>
                    </div>
                </div>
                
                <div class="info-item" id="themeSettingsBtn">
                    <div class="info-icon">
                        <i class="fas fa-palette"></i>
                    </div>
                    <div class="info-content">
                        <div class="info-title">ÿßŸÑŸÖÿ∏Ÿáÿ±</div>
                        <div class="info-subtitle">ÿ™ÿÆÿµŸäÿµ ŸÖÿ∏Ÿáÿ± ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ</div>
                    </div>
                </div>
                
                <div class="info-item" id="helpCenterBtn">
                    <div class="info-icon">
                        <i class="fas fa-question-circle"></i>
                    </div>
                    <div class="info-content">
                        <div class="info-title">ŸÖÿ±ŸÉÿ≤ ÿßŸÑŸÖÿ≥ÿßÿπÿØÿ©</div>
                        <div class="info-subtitle">ÿßŸÑÿØÿπŸÖ ŸàÿßŸÑŸÖÿ≥ÿßÿπÿØÿ©</div>
                    </div>
                </div>
            </div>
            
            <button class="btn-primary logout-btn" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i> ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨
            </button>
        </div>
        
        <!-- New Chat Screen -->
        <div id="newChatScreen" class="screen hidden">
            <div class="app-header">
                <div class="back-btn" id="backFromNewChatBtn">
                    <i class="fas fa-arrow-right"></i>
                </div>
                
                <div class="app-logo">ÿØÿ±ÿØÿ¥ÿ© ÿ¨ÿØŸäÿØÿ©</div>
            </div>
            
            <div class="new-chat-container">
                <div class="search-box">
                    <div class="input-group">
                        <input type="text" class="search-input" id="contactSearch" placeholder="ÿßÿ®ÿ≠ÿ´ ÿπŸÜ ÿ¨Ÿáÿßÿ™ ÿßŸÑÿßÿ™ÿµÿßŸÑ...">
                        <div class="input-icon">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                </div>
                
                <div id="contactsList">
                    <!-- Contacts will be loaded here -->
                </div>
            </div>
        </div>
        
        <!-- Call Screen -->
        <div id="callScreen" class="screen hidden">
            <div class="call-header">
                <img id="callerAvatar" src="" class="caller-avatar">
                <div class="caller-name" id="callerName"></div>
                <div class="call-status" id="callStatus">Ÿäÿ™ŸÖ ÿßŸÑÿßÿ™ÿµÿßŸÑ...</div>
                <div class="call-timer" id="callTimer">00:00</div>
            </div>
            
            <div class="call-controls">
                <div class="call-btn speaker" id="speakerBtn">
                    <i class="fas fa-volume-up"></i>
                </div>
                <div class="call-btn mute" id="muteBtn">
                    <i class="fas fa-microphone"></i>
                </div>
                <div class="call-btn" id="endCallBtn">
                    <i class="fas fa-phone-slash"></i>
                </div>
            </div>
        </div>
        
        <!-- Incoming Call Screen -->
        <div id="incomingCallScreen" class="screen hidden">
            <div class="call-header">
                <img id="incomingCallerAvatar" src="" class="caller-avatar">
                <div class="caller-name" id="incomingCallerName"></div>
                <div class="call-status" id="incomingCallType">ŸÖŸÉÿßŸÑŸÖÿ© ÿµŸàÿ™Ÿäÿ© Ÿàÿßÿ±ÿØÿ©</div>
            </div>
            
            <div class="call-controls">
                <div class="call-btn" id="declineCallBtn">
                    <i class="fas fa-phone-slash"></i>
                </div>
                <div class="call-btn accept" id="acceptCallBtn">
                    <i class="fas fa-phone"></i>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modals -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal" id="modal">
            <!-- Modal content will be loaded dynamically -->
        </div>
    </div>

    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    
    <script>
        // ÿ™ÿ∑ÿ®ŸäŸÇ ÿ±ŸàŸÜ - ÿ™ÿ∑ÿ®ŸäŸÇ ÿØÿ±ÿØÿ¥ÿ© ŸÖÿ™ŸÉÿßŸÖŸÑ
        class RonApp {
            constructor() {
                this.currentUser = null;
                this.currentScreen = 'loading';
                this.currentChat = null;
                this.currentCall = null;
                this.callTimer = null;
                this.callStartTime = null;
                this.isMuted = false;
                this.isSpeaker = false;
                this.darkMode = false;
                
                // ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ
                this.users = [];
                this.chats = [];
                this.messages = {};
                this.calls = [];
                this.stories = [];
                this.contacts = [];
                this.settings = {};
                
                this.init();
            }
            
            init() {
                this.loadData();
                this.setupEventListeners();
                this.showLoadingScreen();
                
                // ŸÖÿ≠ÿßŸÉÿßÿ© ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ
                setTimeout(() => {
                    this.checkAuth();
                }, 1500);
            }
            
            loadData() {
                // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÖŸÜ localStorage ÿ£Ÿà ÿ™ŸáŸäÿ¶ÿ© ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©
                this.users = JSON.parse(localStorage.getItem('ron_users')) || this.getDefaultUsers();
                this.chats = JSON.parse(localStorage.getItem('ron_chats')) || this.getDefaultChats();
                this.messages = JSON.parse(localStorage.getItem('ron_messages')) || this.getDefaultMessages();
                this.calls = JSON.parse(localStorage.getItem('ron_calls')) || this.getDefaultCalls();
                this.stories = JSON.parse(localStorage.getItem('ron_stories')) || this.getDefaultStories();
                this.contacts = JSON.parse(localStorage.getItem('ron_contacts')) || this.getDefaultContacts();
                this.settings = JSON.parse(localStorage.getItem('ron_settings')) || this.getDefaultSettings();
                
                // ÿ™ÿ≠ŸÖŸäŸÑ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ≥ŸÖÿ©
                this.darkMode = this.settings.darkMode || false;
                if (this.darkMode) {
                    document.body.classList.add('dark-mode');
                    document.querySelector('#themeToggle i').classList.remove('fa-moon');
                    document.querySelector('#themeToggle i').classList.add('fa-sun');
                }
            }
            
            saveData() {
                localStorage.setItem('ron_users', JSON.stringify(this.users));
                localStorage.setItem('ron_chats', JSON.stringify(this.chats));
                localStorage.setItem('ron_messages', JSON.stringify(this.messages));
                localStorage.setItem('ron_calls', JSON.stringify(this.calls));
                localStorage.setItem('ron_stories', JSON.stringify(this.stories));
                localStorage.setItem('ron_contacts', JSON.stringify(this.contacts));
                localStorage.setItem('ron_settings', JSON.stringify(this.settings));
            }
            
            getDefaultUsers() {
                return [
                    {
                        id: 1,
                        name: 'ÿ£ÿ≠ŸÖÿØ ŸÖÿ≠ŸÖÿØ',
                        username: 'ahmed',
                        email: 'ahmed@example.com',
                        password: '123456',
                        avatar: 'https://randomuser.me/api/portraits/men/32.jpg',
                        status: 'ŸÖÿ™ÿµŸÑ ÿßŸÑÿ¢ŸÜ',
                        online: true,
                        lastSeen: Date.now(),
                        bio: 'ŸÖÿ∑Ÿàÿ± ŸàŸäÿ® ŸàŸÖÿµŸÖŸÖ',
                        phone: '+966500000001'
                    },
                    {
                        id: 2,
                        name: 'ÿ≥ÿßÿ±ÿ© ÿ£ÿ≠ŸÖÿØ',
                        username: 'sara',
                        email: 'sara@example.com',
                        password: '123456',
                        avatar: 'https://randomuser.me/api/portraits/women/44.jpg',
                        status: 'ŸÖÿ™ÿµŸÑ ÿßŸÑÿ¢ŸÜ',
                        online: true,
                        lastSeen: Date.now(),
                        bio: 'ŸÖŸáŸÜÿØÿ≥ÿ© ÿ®ÿ±ŸÖÿ¨Ÿäÿßÿ™',
                        phone: '+966500000002'
                    },
                    {
                        id: 3,
                        name: 'ŸÖÿ≠ŸÖÿØ ÿπŸÑŸä',
                        username: 'mohammed',
                        email: 'mohammed@example.com',
                        password: '123456',
                        avatar: 'https://randomuser.me/api/portraits/men/22.jpg',
                        status: 'ÿ¢ÿÆÿ± ÿ∏ŸáŸàÿ± ŸÇÿ®ŸÑ 5 ÿØŸÇÿßÿ¶ŸÇ',
                        online: false,
                        lastSeen: Date.now() - 300000,
                        bio: 'ÿ∑ÿßŸÑÿ® ŸáŸÜÿØÿ≥ÿ©',
                        phone: '+966500000003'
                    },
                    {
                        id: 4,
                        name: 'ŸÅÿßÿ∑ŸÖÿ© ÿ≥ÿßŸÑŸÖ',
                        username: 'fatima',
                        email: 'fatima@example.com',
                        password: '123456',
                        avatar: 'https://randomuser.me/api/portraits/women/33.jpg',
                        status: 'ÿ¢ÿÆÿ± ÿ∏ŸáŸàÿ± ŸÇÿ®ŸÑ ÿ≥ÿßÿπÿ©',
                        online: false,
                        lastSeen: Date.now() - 3600000,
                        bio: 'ŸÖÿµŸÖŸÖÿ© ÿ¨ÿ±ÿßŸÅŸäŸÉ',
                        phone: '+966500000004'
                    },
                    {
                        id: 5,
                        name: 'ÿÆÿßŸÑÿØ ÿ≥ÿπŸäÿØ',
                        username: 'khaled',
                        email: 'khaled@example.com',
                        password: '123456',
                        avatar: 'https://randomuser.me/api/portraits/men/65.jpg',
                        status: 'ŸÖÿ™ÿµŸÑ ÿßŸÑÿ¢ŸÜ',
                        online: true,
                        lastSeen: Date.now(),
                        bio: 'ŸÖÿØŸäÿ± ŸÖÿ¥ÿßÿ±Ÿäÿπ',
                        phone: '+966500000005'
                    }
                ];
            }
            
            getDefaultChats() {
                return [
                    {
                        id: 1,
                        userId: 2,
                        lastMessage: 'ŸÖÿ±ÿ≠ÿ®ÿßŸã! ŸÉŸäŸÅ ÿ≠ÿßŸÑŸÉÿü',
                        time: '10:30 ÿµ',
                        unread: 3,
                        lastMessageTime: Date.now() - 3600000,
                        pinned: true
                    },
                    {
                        id: 2,
                        userId: 3,
                        lastMessage: 'ÿ¥ŸÉÿ±ÿßŸã ÿπŸÑŸâ ÿßŸÑŸÖÿ≥ÿßÿπÿØÿ©',
                        time: 'ÿ£ŸÖÿ≥',
                        unread: 0,
                        lastMessageTime: Date.now() - 86400000,
                        pinned: false
                    },
                    {
                        id: 3,
                        userId: 4,
                        lastMessage: 'ŸáŸÑ ŸäŸÖŸÉŸÜŸÜÿß ÿßŸÑÿßÿ¨ÿ™ŸÖÿßÿπ ÿ∫ÿØÿßŸãÿü',
                        time: 'ÿßŸÑÿ´ŸÑÿßÿ´ÿßÿ°',
                        unread: 1,
                        lastMessageTime: Date.now() - 172800000,
                        pinned: false
                    },
                    {
                        id: 4,
                        userId: 5,
                        lastMessage: 'ÿ±ÿ£Ÿäÿ™ ŸÖŸÜÿ¥Ÿàÿ±ŸÉ ÿßŸÑÿ¨ÿØŸäÿØÿå ÿ±ÿßÿ¶ÿπ!',
                        time: 'ÿßŸÑÿ•ÿ´ŸÜŸäŸÜ',
                        unread: 0,
                        lastMessageTime: Date.now() - 259200000,
                        pinned: true
                    }
                ];
            }
            
            getDefaultMessages() {
                return {
                    1: [
                        { id: 1, text: 'ŸÖÿ±ÿ≠ÿ®ÿßŸã ÿ£ÿ≠ŸÖÿØ!', senderId: 2, time: '10:25 ÿµ', timestamp: Date.now() - 3900000, read: true },
                        { id: 2, text: 'ÿ£ŸáŸÑÿßŸã ÿ≥ÿßÿ±ÿ©! ŸÉŸäŸÅ ÿ≠ÿßŸÑŸÉÿü', senderId: 1, time: '10:26 ÿµ', timestamp: Date.now() - 3840000, read: true },
                        { id: 3, text: 'ÿ£ŸÜÿß ÿ®ÿÆŸäÿ± ÿßŸÑÿ≠ŸÖÿØŸÑŸÑŸáÿå ÿ¥ŸÉÿ±ÿßŸã ŸÑÿ≥ÿ§ÿßŸÑŸÉ', senderId: 2, time: '10:27 ÿµ', timestamp: Date.now() - 3780000, read: true },
                        { id: 4, text: 'ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ŸÅÿ±ÿ∫ ŸÑŸÑÿ≠ÿØŸäÿ´ ÿßŸÑÿ¢ŸÜÿü', senderId: 2, time: '10:28 ÿµ', timestamp: Date.now() - 3720000, read: true },
                        { id: 5, text: 'ŸÜÿπŸÖÿå ÿ£ŸÜÿß ŸÖÿ™ŸÅÿ±ÿ∫. ŸÖÿßÿ∞ÿß ÿ™ÿ±ŸäÿØŸäŸÜÿü', senderId: 1, time: '10:29 ÿµ', timestamp: Date.now() - 3660000, read: true },
                        { id: 6, text: 'ÿ£ÿ≠ÿ™ÿßÿ¨ ŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ŸÅŸä ŸÖÿ¥ÿ±ŸàÿπŸä ÿßŸÑÿ¨ÿØŸäÿØ', senderId: 2, time: '10:30 ÿµ', timestamp: Date.now() - 3600000, read: false }
                    ],
                    2: [
                        { id: 1, text: 'ÿ¥ŸÉÿ±ÿßŸã ÿ¨ÿ≤ŸäŸÑÿßŸã ÿπŸÑŸâ ŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ÿ£ŸÖÿ≥', senderId: 3, time: '09:15 ÿµ', timestamp: Date.now() - 4500000, read: true },
                        { id: 2, text: 'ÿßŸÑÿπŸÅŸà Ÿäÿß ŸÖÿ≠ŸÖÿØÿå ÿØÿßÿ¶ŸÖÿßŸã ŸÅŸä ÿßŸÑÿÆÿØŸÖÿ©', senderId: 1, time: '09:16 ÿµ', timestamp: Date.now() - 4440000, read: true }
                    ],
                    3: [
                        { id: 1, text: 'ŸÖÿ±ÿ≠ÿ®ÿßŸã ÿ£ÿ≠ŸÖÿØÿå ŸáŸÑ ŸäŸÖŸÉŸÜŸÜÿß ÿßŸÑÿßÿ¨ÿ™ŸÖÿßÿπ ÿ∫ÿØÿßŸãÿü', senderId: 4, time: '14:30 ŸÖ', timestamp: Date.now() - 172800000, read: false }
                    ],
                    4: [
                        { id: 1, text: 'ÿ±ÿ£Ÿäÿ™ ŸÖŸÜÿ¥Ÿàÿ±ŸÉ ÿßŸÑÿ¨ÿØŸäÿØÿå ÿ±ÿßÿ¶ÿπ!', senderId: 5, time: '11:45 ÿµ', timestamp: Date.now() - 259200000, read: true },
                        { id: 2, text: 'ÿ¥ŸÉÿ±ÿßŸã ŸÑŸÉ ÿÆÿßŸÑÿØ!', senderId: 1, time: '11:46 ÿµ', timestamp: Date.now() - 259194000, read: true }
                    ]
                };
            }
            
            getDefaultCalls() {
                return [
                    {
                        id: 1,
                        userId: 2,
                        type: 'outgoing',
                        status: 'answered',
                        duration: 325,
                        time: '10:15 ÿµ',
                        timestamp: Date.now() - 7200000
                    },
                    {
                        id: 2,
                        userId: 3,
                        type: 'incoming',
                        status: 'answered',
                        duration: 180,
                        time: 'ÿ£ŸÖÿ≥',
                        timestamp: Date.now() - 86400000
                    },
                    {
                        id: 3,
                        userId: 4,
                        type: 'incoming',
                        status: 'missed',
                        duration: 0,
                        time: 'ÿßŸÑÿ´ŸÑÿßÿ´ÿßÿ°',
                        timestamp: Date.now() - 172800000
                    },
                    {
                        id: 4,
                        userId: 5,
                        type: 'outgoing',
                        status: 'answered',
                        duration: 420,
                        time: 'ÿßŸÑÿ•ÿ´ŸÜŸäŸÜ',
                        timestamp: Date.now() - 259200000
                    }
                ];
            }
            
            getDefaultStories() {
                return [
                    { id: 1, userId: 2, active: true, timestamp: Date.now() - 3600000, seen: false },
                    { id: 2, userId: 4, active: true, timestamp: Date.now() - 7200000, seen: true },
                    { id: 3, userId: 5, active: true, timestamp: Date.now() - 10800000, seen: false }
                ];
            }
            
            getDefaultContacts() {
                return [
                    { id: 2, name: 'ÿ≥ÿßÿ±ÿ© ÿ£ÿ≠ŸÖÿØ', avatar: 'https://randomuser.me/api/portraits/women/44.jpg', phone: '+966500000002' },
                    { id: 3, name: 'ŸÖÿ≠ŸÖÿØ ÿπŸÑŸä', avatar: 'https://randomuser.me/api/portraits/men/22.jpg', phone: '+966500000003' },
                    { id: 4, name: 'ŸÅÿßÿ∑ŸÖÿ© ÿ≥ÿßŸÑŸÖ', avatar: 'https://randomuser.me/api/portraits/women/33.jpg', phone: '+966500000004' },
                    { id: 5, name: 'ÿÆÿßŸÑÿØ ÿ≥ÿπŸäÿØ', avatar: 'https://randomuser.me/api/portraits/men/65.jpg', phone: '+966500000005' },
                    { id: 6, name: 'ŸÑŸÖŸäÿßÿ° ŸÖÿ≠ŸÖÿØ', avatar: 'https://randomuser.me/api/portraits/women/68.jpg', phone: '+966500000006' },
                    { id: 7, name: 'ÿπŸÖÿ± ÿ≠ÿ≥ŸÜ', avatar: 'https://randomuser.me/api/portraits/men/75.jpg', phone: '+966500000007' },
                    { id: 8, name: 'ŸÜŸàÿ±ÿ© ÿπÿ®ÿØÿßŸÑŸÑŸá', avatar: 'https://randomuser.me/api/portraits/women/26.jpg', phone: '+966500000008' }
                ];
            }
            
            getDefaultSettings() {
                return {
                    darkMode: false,
                    notifications: true,
                    sound: true,
                    vibration: true,
                    privacy: {
                        lastSeen: 'everyone',
                        profilePhoto: 'everyone',
                        status: 'everyone'
                    },
                    theme: 'default'
                };
            }
            
            checkAuth() {
                const currentUser = JSON.parse(localStorage.getItem('ron_currentUser'));
                if (currentUser) {
                    this.currentUser = currentUser;
                    this.showMainScreen();
                    this.loadChatsScreen();
                } else {
                    this.showAuthScreen();
                }
            }
            
            showLoadingScreen() {
                this.hideAllScreens();
                document.getElementById('loadingScreen').classList.add('active');
                this.currentScreen = 'loading';
            }
            
            showAuthScreen() {
                this.hideAllScreens();
                document.getElementById('authScreen').classList.add('active');
                this.currentScreen = 'auth';
            }
            
            showMainScreen() {
                this.hideAllScreens();
                document.getElementById('mainScreen').classList.add('active');
                this.currentScreen = 'main';
                
                // ÿ™ÿ≠ÿØŸäÿ´ ÿµŸàÿ±ÿ© ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä ŸÅŸä ÿßŸÑŸáŸäÿØÿ±
                if (this.currentUser) {
                    document.getElementById('headerProfileImg').src = this.currentUser.avatar;
                }
            }
            
            showChatScreen() {
                this.hideAllScreens();
                document.getElementById('chatScreen').classList.add('active');
                this.currentScreen = 'chat';
            }
            
            showProfileScreen() {
                this.hideAllScreens();
                document.getElementById('profileScreen').classList.add('active');
                
                // ÿ™ÿ≠ÿØŸäÿ´ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä
                if (this.currentUser) {
                    document.getElementById('profileAvatar').src = this.currentUser.avatar;
                    document.getElementById('profileName').textContent = this.currentUser.name;
                    document.getElementById('profileStatus').textContent = this.currentUser.status;
                }
            }
            
            showNewChatScreen() {
                this.hideAllScreens();
                document.getElementById('newChatScreen').classList.add('active');
                this.loadContacts();
            }
            
            showCallScreen() {
                this.hideAllScreens();
                document.getElementById('callScreen').classList.add('active');
            }
            
            showIncomingCallScreen() {
                this.hideAllScreens();
                document.getElementById('incomingCallScreen').classList.add('active');
            }
            
            hideAllScreens() {
                document.querySelectorAll('.screen').forEach(screen => {
                    screen.classList.remove('active');
                });
            }
            
            setupEventListeners() {
                // ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ
                document.getElementById('loginBtn').addEventListener('click', () => this.login());
                document.getElementById('registerBtn').addEventListener('click', () => this.register());
                document.getElementById('showRegisterBtn').addEventListener('click', (e) => {
                    e.preventDefault();
                    document.getElementById('loginForm').classList.add('hidden');
                    document.getElementById('registerForm').classList.remove('hidden');
                });
                document.getElementById('showLoginBtn').addEventListener('click', (e) => {
                    e.preventDefault();
                    document.getElementById('registerForm').classList.add('hidden');
                    document.getElementById('loginForm').classList.remove('hidden');
                });
                
                // ÿßŸÑÿ™ŸÜŸÇŸÑ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä
                document.getElementById('profileBtn').addEventListener('click', () => this.showProfileScreen());
                document.getElementById('newChatBtn').addEventListener('click', () => this.showNewChatScreen());
                document.getElementById('themeToggle').addEventListener('click', () => this.toggleTheme());
                document.getElementById('searchBtn').addEventListener('click', () => this.showSearch());
                
                // ÿßŸÑÿ™ŸÜŸÇŸÑ ŸÅŸä ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ≥ŸÅŸÑŸäÿ©
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        const page = e.currentTarget.getAttribute('data-page');
                        this.navigateTo(page);
                    });
                });
                
                // ÿßŸÑÿØÿ±ÿØÿ¥ÿ©
                document.getElementById('backFromChatBtn').addEventListener('click', () => {
                    this.showMainScreen();
                    this.navigateTo('chats');
                });
                document.getElementById('sendMessageBtn').addEventListener('click', () => this.sendMessage());
                document.getElementById('messageInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        this.sendMessage();
                    }
                });
                document.getElementById('messageInput').addEventListener('input', function() {
                    this.style.height = 'auto';
                    this.style.height = (this.scrollHeight) + 'px';
                });
                
                // ÿßŸÑŸÖŸÉÿßŸÑŸÖÿßÿ™
                document.getElementById('audioCallBtn').addEventListener('click', () => this.startAudioCall());
                document.getElementById('videoCallBtn').addEventListener('click', () => this.startVideoCall());
                document.getElementById('acceptCallBtn').addEventListener('click', () => this.acceptCall());
                document.getElementById('declineCallBtn').addEventListener('click', () => this.declineCall());
                document.getElementById('endCallBtn').addEventListener('click', () => this.endCall());
                document.getElementById('muteBtn').addEventListener('click', () => this.toggleMute());
                document.getElementById('speakerBtn').addEventListener('click', () => this.toggleSpeaker());
                
                // ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä
                document.getElementById('backFromProfileBtn').addEventListener('click', () => {
                    this.showMainScreen();
                    this.navigateTo('chats');
                });
                document.getElementById('logoutBtn').addEventListener('click', () => this.logout());
                document.getElementById('editProfileBtn').addEventListener('click', () => this.showEditProfileModal());
                document.getElementById('notificationsSettingsBtn').addEventListener('click', () => this.showNotificationsSettings());
                document.getElementById('privacySettingsBtn').addEventListener('click', () => this.showPrivacySettings());
                document.getElementById('themeSettingsBtn').addEventListener('click', () => this.showThemeSettings());
                document.getElementById('helpCenterBtn').addEventListener('click', () => this.showHelpCenter());
                
                // ÿØÿ±ÿØÿ¥ÿ© ÿ¨ÿØŸäÿØÿ©
                document.getElementById('backFromNewChatBtn').addEventListener('click', () => {
                    this.showMainScreen();
                    this.navigateTo('chats');
                });
                
                // ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ÿ¨Ÿáÿßÿ™ ÿßÿ™ÿµÿßŸÑ
                document.getElementById('contactSearch').addEventListener('input', (e) => this.searchContacts(e.target.value));
                
                // ÿ•ÿ±ŸÅÿßŸÇ ŸÖŸÑŸÅÿßÿ™
                document.getElementById('attachBtn').addEventListener('click', () => this.showAttachMenu());
                document.getElementById('cameraBtn').addEventListener('click', () => this.openCamera());
                
                // ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿØÿ±ÿØÿ¥ÿ©
                document.getElementById('chatMenuBtn').addEventListener('click', () => this.showChatMenu());
            }
            
            login() {
                const username = document.getElementById('loginUsername').value.trim();
                const password = document.getElementById('loginPassword').value.trim();
                
                if (!username || !password) {
                    this.showToast('ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸàŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±', 'error');
                    return;
                }
                
                const user = this.users.find(u => 
                    (u.username === username || u.email === username) && 
                    u.password === password
                );
                
                if (user) {
                    this.currentUser = user;
                    localStorage.setItem('ron_currentUser', JSON.stringify(user));
                    this.showMainScreen();
                    this.loadChatsScreen();
                    this.showToast('ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ÿ®ŸÜÿ¨ÿßÿ≠!', 'success');
                } else {
                    this.showToast('ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ£Ÿà ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠ÿ©', 'error');
                }
            }
            
            register() {
                const name = document.getElementById('registerName').value.trim();
                const username = document.getElementById('registerUsername').value.trim();
                const email = document.getElementById('registerEmail').value.trim();
                const password = document.getElementById('registerPassword').value.trim();
                const confirmPassword = document.getElementById('registerConfirmPassword').value.trim();
                
                // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ≠ŸÇŸàŸÑ
                if (!name || !username || !email || !password || !confirmPassword) {
                    this.showToast('ÿßŸÑÿ±ÿ¨ÿßÿ° ŸÖŸÑÿ° ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÑ', 'error');
                    return;
                }
                
                if (password !== confirmPassword) {
                    this.showToast('ŸÉŸÑŸÖÿ™ÿß ÿßŸÑŸÖÿ±Ÿàÿ± ÿ∫Ÿäÿ± ŸÖÿ™ÿ∑ÿßÿ®ŸÇÿ™ŸäŸÜ', 'error');
                    return;
                }
                
                if (password.length < 6) {
                    this.showToast('ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± Ÿäÿ¨ÿ® ÿ£ŸÜ ÿ™ŸÉŸàŸÜ 6 ÿ£ÿ≠ÿ±ŸÅ ÿπŸÑŸâ ÿßŸÑÿ£ŸÇŸÑ', 'error');
                    return;
                }
                
                // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿπÿØŸÖ ÿ™ŸÉÿ±ÿßÿ± ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ£Ÿà ÿßŸÑÿ®ÿ±ŸäÿØ
                if (this.users.some(u => u.username === username)) {
                    this.showToast('ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÖŸàÿ¨ŸàÿØ ÿ®ÿßŸÑŸÅÿπŸÑ', 'error');
                    return;
                }
                
                if (this.users.some(u => u.email === email)) {
                    this.showToast('ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä ŸÖŸàÿ¨ŸàÿØ ÿ®ÿßŸÑŸÅÿπŸÑ', 'error');
                    return;
                }
                
                // ÿ•ŸÜÿ¥ÿßÿ° ŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ¨ÿØŸäÿØ
                const newUser = {
                    id: this.users.length + 1,
                    name: name,
                    username: username,
                    email: email,
                    password: password,
                    avatar: `https://randomuser.me/api/portraits/${Math.random() > 0.5 ? 'men' : 'women'}/${Math.floor(Math.random() * 100)}.jpg`,
                    status: 'ŸÖÿ™ÿµŸÑ ÿßŸÑÿ¢ŸÜ',
                    online: true,
                    lastSeen: Date.now(),
                    bio: 'ŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ¨ÿØŸäÿØ ŸÅŸä ÿ±ŸàŸÜ',
                    phone: '+9665000000' + (this.users.length + 10)
                };
                
                this.users.push(newUser);
                this.currentUser = newUser;
                
                // ÿ≠ŸÅÿ∏ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
                this.saveData();
                localStorage.setItem('ron_currentUser', JSON.stringify(newUser));
                
                // ÿßŸÑÿπŸàÿØÿ© ŸÑŸÑÿ¥ÿßÿ¥ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
                this.showMainScreen();
                this.loadChatsScreen();
                this.showToast('ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ≠ÿ≥ÿßÿ® ÿ®ŸÜÿ¨ÿßÿ≠!', 'success');
            }
            
            logout() {
                if (confirm('ŸáŸÑ ÿ™ÿ±ŸäÿØ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨ÿü')) {
                    this.currentUser = null;
                    localStorage.removeItem('ron_currentUser');
                    this.showAuthScreen();
                    this.showToast('ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨', 'info');
                }
            }
            
            navigateTo(page) {
                // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ≥ŸÅŸÑŸäÿ©
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                    if (item.getAttribute('data-page') === page) {
                        item.classList.add('active');
                    }
                });
                
                // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑŸÖŸÜÿßÿ≥ÿ®
                switch(page) {
                    case 'chats':
                        this.loadChatsScreen();
                        break;
                    case 'calls':
                        this.loadCallsScreen();
                        break;
                    case 'contacts':
                        this.loadContactsScreen();
                        break;
                    case 'status':
                        this.loadStatusScreen();
                        break;
                    case 'settings':
                        this.loadSettingsScreen();
                        break;
                }
            }
            
            loadChatsScreen() {
                const contentArea = document.getElementById('contentArea');
                let html = `
                    <div class="stories-container">
                        <div class="stories-list" id="storiesList">
                            <div class="story-item" onclick="ronApp.showNewStoryModal()">
                                <div class="story-avatar">
                                    <div style="width: 54px; height: 54px; border-radius: 50%; background: var(--bg-secondary); display: flex; align-items: center; justify-content: center;">
                                        <i class="fas fa-plus" style="font-size: 20px; color: var(--text-secondary);"></i>
                                    </div>
                                </div>
                                <div class="story-name">ŸÇÿµÿ© ÿ¨ÿØŸäÿØÿ©</div>
                            </div>
                `;
                
                // ÿπÿ±ÿ∂ ÿßŸÑŸÇÿµÿµ
                this.stories.forEach(story => {
                    const user = this.users.find(u => u.id === story.userId);
                    if (user) {
                        const seenClass = story.seen ? '' : 'active';
                        html += `
                            <div class="story-item" onclick="ronApp.viewStory(${story.id})">
                                <div class="story-avatar ${seenClass}">
                                    <img src="${user.avatar}" alt="${user.name}">
                                </div>
                                <div class="story-name">${user.name}</div>
                            </div>
                        `;
                    }
                });
                
                html += `
                        </div>
                    </div>
                    <div class="chats-list" id="chatsListContainer">
                `;
                
                // ÿπÿ±ÿ∂ ÿßŸÑÿØÿ±ÿØÿ¥ÿßÿ™
                const sortedChats = [...this.chats].sort((a, b) => b.lastMessageTime - a.lastMessageTime);
                const pinnedChats = sortedChats.filter(chat => chat.pinned);
                const otherChats = sortedChats.filter(chat => !chat.pinned);
                
                if (pinnedChats.length > 0) {
                    html += `<div style="padding: 16px 16px 8px; font-weight: 600; color: var(--text-secondary); font-size: 14px;">ŸÖÿ´ÿ®ÿ™ÿ©</div>`;
                    pinnedChats.forEach(chat => {
                        html += this.getChatItemHTML(chat);
                    });
                }
                
                if (otherChats.length > 0) {
                    html += `<div style="padding: 16px 16px 8px; font-weight: 600; color: var(--text-secondary); font-size: 14px;">ÿ¨ŸÖŸäÿπ ÿßŸÑÿØÿ±ÿØÿ¥ÿßÿ™</div>`;
                    otherChats.forEach(chat => {
                        html += this.getChatItemHTML(chat);
                    });
                }
                
                html += `</div>`;
                contentArea.innerHTML = html;
                
                // ÿ•ÿ∂ÿßŸÅÿ© ÿ£ÿ≠ÿØÿßÿ´ ÿßŸÑŸÜŸÇÿ± ÿπŸÑŸâ ÿßŸÑÿØÿ±ÿØÿ¥ÿßÿ™
                document.querySelectorAll('.chat-item').forEach(item => {
                    item.addEventListener('click', () => {
                        const chatId = parseInt(item.getAttribute('data-chat-id'));
                        const userId = parseInt(item.getAttribute('data-user-id'));
                        this.openChat(chatId, userId);
                    });
                });
            }
            
            getChatItemHTML(chat) {
                const user = this.users.find(u => u.id === chat.userId);
                if (!user) return '';
                
                const onlineStatus = user.online ? 'online-status' : 'online-status offline';
                const statusText = user.online ? 'ŸÖÿ™ÿµŸÑ ÿßŸÑÿ¢ŸÜ' : user.status;
                
                return `
                    <div class="chat-item" data-chat-id="${chat.id}" data-user-id="${chat.userId}">
                        <div class="chat-avatar">
                            <img src="${user.avatar}" alt="${user.name}" class="chat-img">
                            <div class="${onlineStatus}"></div>
                        </div>
                        
                        <div class="chat-info">
                            <div class="chat-header">
                                <div class="chat-name">${user.name}</div>
                                <div class="chat-time">${chat.time}</div>
                            </div>
                            
                            <div class="chat-preview">
                                <div class="chat-message">${chat.lastMessage}</div>
                                ${chat.unread > 0 ? `<div class="unread-count">${chat.unread}</div>` : ''}
                            </div>
                        </div>
                    </div>
                `;
            }
            
            openChat(chatId, userId) {
                const user = this.users.find(u => u.id === userId);
                if (!user) return;
                
                this.currentChat = { id: chatId, userId: userId };
                
                // ÿ™ÿ≠ÿØŸäÿ´ Ÿàÿßÿ¨Ÿáÿ© ÿßŸÑÿØÿ±ÿØÿ¥ÿ©
                document.getElementById('chatUserName').textContent = user.name;
                document.getElementById('chatUserImg').src = user.avatar;
                document.getElementById('chatUserStatusText').textContent = user.online ? 'ŸÖÿ™ÿµŸÑ ÿßŸÑÿ¢ŸÜ' : user.status;
                
                const statusElement = document.getElementById('chatUserStatus');
                if (user.online) {
                    statusElement.classList.remove('offline');
                } else {
                    statusElement.classList.add('offline');
                }
                
                // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ
                this.loadMessages(chatId);
                
                // ÿπÿ±ÿ∂ ÿ¥ÿßÿ¥ÿ© ÿßŸÑÿØÿ±ÿØÿ¥ÿ©
                this.showChatScreen();
            }
            
            loadMessages(chatId) {
                const chatMessages = this.messages[chatId] || [];
                const messagesContainer = document.getElementById('chatMessages');
                
                let html = '';
                chatMessages.forEach(msg => {
                    const isSent = msg.senderId === this.currentUser.id;
                    const sender = this.users.find(u => u.id === msg.senderId);
                    
                    html += `
                        <div class="message ${isSent ? 'sent' : 'received'}">
                            ${!isSent ? `<img src="${sender?.avatar || 'https://randomuser.me/api/portraits/men/32.jpg'}" class="message-avatar">` : ''}
                            <div class="message-bubble">
                                <div class="message-text">${msg.text}</div>
                                <div class="message-time">${msg.time}</div>
                            </div>
                            ${isSent ? `<img src="${this.currentUser.avatar}" class="message-avatar">` : ''}
                        </div>
                    `;
                });
                
                messagesContainer.innerHTML = html;
                
                // ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ÿ•ŸÑŸâ ÿßŸÑÿ£ÿ≥ŸÅŸÑ
                setTimeout(() => {
                    messagesContainer.scrollTop = messagesContainer.scrollHeight;
                }, 100);
            }
            
            sendMessage() {
                const input = document.getElementById('messageInput');
                const text = input.value.trim();
                
                if (!text || !this.currentChat) return;
                
                // ÿ•ŸÜÿ¥ÿßÿ° ÿ±ÿ≥ÿßŸÑÿ© ÿ¨ÿØŸäÿØÿ©
                const now = new Date();
                const time = `${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')}`;
                
                const newMessage = {
                    id: Date.now(),
                    text: text,
                    senderId: this.currentUser.id,
                    time: time,
                    timestamp: Date.now(),
                    read: false
                };
                
                // ÿ≠ŸÅÿ∏ ÿßŸÑÿ±ÿ≥ÿßŸÑÿ©
                if (!this.messages[this.currentChat.id]) {
                    this.messages[this.currentChat.id] = [];
                }
                this.messages[this.currentChat.id].push(newMessage);
                
                // ÿ™ÿ≠ÿØŸäÿ´ ÿ¢ÿÆÿ± ÿ±ÿ≥ÿßŸÑÿ© ŸÅŸä ÿßŸÑÿØÿ±ÿØÿ¥ÿ©
                const chatIndex = this.chats.findIndex(c => c.id === this.currentChat.id);
                if (chatIndex !== -1) {
                    this.chats[chatIndex].lastMessage = text;
                    this.chats[chatIndex].time = time;
                    this.chats[chatIndex].lastMessageTime = Date.now();
                    this.chats[chatIndex].unread = 0;
                }
                
                // ÿ≠ŸÅÿ∏ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
                this.saveData();
                
                // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ±ÿ≥ÿßŸÑÿ© ÿ•ŸÑŸâ ÿßŸÑŸàÿßÿ¨Ÿáÿ©
                const messagesContainer = document.getElementById('chatMessages');
                const messageHTML = `
                    <div class="message sent">
                        <div class="message-bubble">
                            <div class="message-text">${text}</div>
                            <div class="message-time">${time}</div>
                        </div>
                        <img src="${this.currentUser.avatar}" class="message-avatar">
                    </div>
                `;
                messagesContainer.innerHTML += messageHTML;
                
                // ŸÖÿ≥ÿ≠ ÿ≠ŸÇŸÑ ÿßŸÑÿ•ÿØÿÆÿßŸÑ
                input.value = '';
                input.style.height = 'auto';
                
                // ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ÿ•ŸÑŸâ ÿßŸÑÿ£ÿ≥ŸÅŸÑ
                setTimeout(() => {
                    messagesContainer.scrollTop = messagesContainer.scrollHeight;
                }, 100);
                
                // ŸÖÿ≠ÿßŸÉÿßÿ© ÿ±ÿØ ÿ®ÿπÿØ 1-3 ÿ´ŸàÿßŸÜŸä
                setTimeout(() => {
                    this.sendAutoReply();
                }, 1000 + Math.random() * 2000);
            }
            
            sendAutoReply() {
                if (!this.currentChat) return;
                
                const replies = [
                    'ÿ£ŸáŸÑÿßŸã!',
                    'ŸÉŸäŸÅ ÿ≠ÿßŸÑŸÉÿü',
                    'ŸÜÿπŸÖÿå ÿ£ŸÜÿß ŸáŸÜÿß',
                    'ÿ≥ÿ£ÿ±ÿØ ÿπŸÑŸäŸÉ ŸÇÿ±Ÿäÿ®ÿßŸã',
                    'ŸÖŸÖÿ™ÿßÿ≤!',
                    'ÿ¥ŸÉÿ±ÿßŸã ŸÑŸÉ',
                    'ÿ≠ÿ≥ŸÜÿßŸã',
                    'ÿ±ÿßÿ¶ÿπ!',
                    'ŸÜÿπŸÖ ÿßÿ™ŸÅŸÇ ŸÖÿπŸÉ',
                    'ŸÖÿßÿ∞ÿß ÿ™ŸÇÿµÿØÿü'
                ];
                
                const randomReply = replies[Math.floor(Math.random() * replies.length)];
                const now = new Date();
                const time = `${now.getHours()}:${(now.getMinutes() + 1).toString().padStart(2, '0')}`;
                
                const autoMessage = {
                    id: Date.now(),
                    text: randomReply,
                    senderId: this.currentChat.userId,
                    time: time,
                    timestamp: Date.now(),
                    read: false
                };
                
                // ÿ≠ŸÅÿ∏ ÿßŸÑÿ±ÿ≥ÿßŸÑÿ©
                if (!this.messages[this.currentChat.id]) {
                    this.messages[this.currentChat.id] = [];
                }
                this.messages[this.currentChat.id].push(autoMessage);
                
                // ÿ™ÿ≠ÿØŸäÿ´ ÿ¢ÿÆÿ± ÿ±ÿ≥ÿßŸÑÿ© ŸÅŸä ÿßŸÑÿØÿ±ÿØÿ¥ÿ©
                const chatIndex = this.chats.findIndex(c => c.id === this.currentChat.id);
                if (chatIndex !== -1) {
                    this.chats[chatIndex].lastMessage = randomReply;
                    this.chats[chatIndex].time = time;
                    this.chats[chatIndex].lastMessageTime = Date.now();
                    this.chats[chatIndex].unread = (this.chats[chatIndex].unread || 0) + 1;
                }
                
                // ÿ≠ŸÅÿ∏ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
                this.saveData();
                
                // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ±ÿ≥ÿßŸÑÿ© ÿ•ŸÑŸâ ÿßŸÑŸàÿßÿ¨Ÿáÿ©
                const user = this.users.find(u => u.id === this.currentChat.userId);
                const messagesContainer = document.getElementById('chatMessages');
                const messageHTML = `
                    <div class="message received">
                        <img src="${user?.avatar || 'https://randomuser.me/api/portraits/women/44.jpg'}" class="message-avatar">
                        <div class="message-bubble">
                            <div class="message-text">${randomReply}</div>
                            <div class="message-time">${time}</div>
                        </div>
                    </div>
                `;
                messagesContainer.innerHTML += messageHTML;
                
                // ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ÿ•ŸÑŸâ ÿßŸÑÿ£ÿ≥ŸÅŸÑ
                setTimeout(() => {
                    messagesContainer.scrollTop = messagesContainer.scrollHeight;
                }, 100);
                
                // ÿ™ÿ≠ÿØŸäÿ´ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿØÿ±ÿØÿ¥ÿßÿ™
                this.loadChatsScreen();
            }
            
            startAudioCall() {
                if (!this.currentChat) return;
                
                const user = this.users.find(u => u.id === this.currentChat.userId);
                if (!user) return;
                
                this.currentCall = {
                    id: Date.now(),
                    userId: user.id,
                    type: 'outgoing',
                    status: 'calling'
                };
                
                // ÿ™ÿ≠ÿØŸäÿ´ ÿ¥ÿßÿ¥ÿ© ÿßŸÑŸÖŸÉÿßŸÑŸÖÿ©
                document.getElementById('callerAvatar').src = user.avatar;
                document.getElementById('callerName').textContent = user.name;
                document.getElementById('callStatus').textContent = 'Ÿäÿ™ŸÖ ÿßŸÑÿßÿ™ÿµÿßŸÑ...';
                
                this.showCallScreen();
                
                // ŸÖÿ≠ÿßŸÉÿßÿ© ŸÇÿ®ŸàŸÑ ÿßŸÑŸÖŸÉÿßŸÑŸÖÿ© ÿ®ÿπÿØ 3-5 ÿ´ŸàÿßŸÜŸä
                setTimeout(() => {
                    if (this.currentCall) {
                        this.acceptCall();
                    }
                }, 3000 + Math.random() * 2000);
            }
            
            startVideoCall() {
                this.showToast('ŸÖŸÉÿßŸÑŸÖÿ© ÿßŸÑŸÅŸäÿØŸäŸà ŸÇŸäÿØ ÿßŸÑÿ™ÿ∑ŸàŸäÿ±', 'info');
            }
            
            acceptCall() {
                if (!this.currentCall) return;
                
                this.currentCall.status = 'answered';
                this.callStartTime = Date.now();
                
                // ÿ®ÿØÿ° ÿßŸÑŸÖÿ§ŸÇÿ™
                this.startCallTimer();
                
                // ÿ™ÿ≠ÿØŸäÿ´ Ÿàÿßÿ¨Ÿáÿ© ÿßŸÑŸÖŸÉÿßŸÑŸÖÿ©
                document.getElementById('callStatus').textContent = 'ŸÖŸÉÿßŸÑŸÖÿ© ÿ¨ÿßÿ±Ÿäÿ©';
                
                // ÿ•ÿ∂ÿßŸÅÿ© ÿ≥ÿ¨ŸÑ ÿßŸÑŸÖŸÉÿßŸÑŸÖÿ©
                const user = this.users.find(u => u.id === this.currentCall.userId);
                if (user) {
                    const newCall = {
                        id: Date.now(),
                        userId: user.id,
                        type: 'incoming',
                        status: 'answered',
                        duration: 0,
                        time: 'ÿßŸÑÿ¢ŸÜ',
                        timestamp: Date.now()
                    };
                    
                    this.calls.unshift(newCall);
                    this.saveData();
                }
            }
            
            declineCall() {
                if (this.currentCall) {
                    const user = this.users.find(u => u.id === this.currentCall.userId);
                    if (user) {
                        const newCall = {
                            id: Date.now(),
                            userId: user.id,
                            type: 'incoming',
                            status: 'missed',
                            duration: 0,
                            time: 'ÿßŸÑÿ¢ŸÜ',
                            timestamp: Date.now()
                        };
                        
                        this.calls.unshift(newCall);
                        this.saveData();
                    }
                    
                    this.currentCall = null;
                }
                
                this.showMainScreen();
                this.navigateTo('calls');
            }
            
            endCall() {
                if (this.currentCall && this.callStartTime) {
                    const duration = Math.floor((Date.now() - this.callStartTime) / 1000);
                    
                    // ÿ™ÿ≠ÿØŸäÿ´ ÿ≥ÿ¨ŸÑ ÿßŸÑŸÖŸÉÿßŸÑŸÖÿ©
                    const callIndex = this.calls.findIndex(c => c.timestamp >= this.callStartTime - 1000 && c.timestamp <= this.callStartTime + 1000);
                    if (callIndex !== -1) {
                        this.calls[callIndex].duration = duration;
                        this.calls[callIndex].time = this.formatCallTime(this.calls[callIndex].timestamp);
                        this.saveData();
                    }
                }
                
                this.stopCallTimer();
                this.currentCall = null;
                this.callStartTime = null;
                
                this.showMainScreen();
                this.navigateTo('calls');
            }
            
            startCallTimer() {
                this.stopCallTimer();
                
                this.callTimer = setInterval(() => {
                    if (this.callStartTime) {
                        const elapsed = Math.floor((Date.now() - this.callStartTime) / 1000);
                        const minutes = Math.floor(elapsed / 60).toString().padStart(2, '0');
                        const seconds = (elapsed % 60).toString().padStart(2, '0');
                        document.getElementById('callTimer').textContent = `${minutes}:${seconds}`;
                    }
                }, 1000);
            }
            
            stopCallTimer() {
                if (this.callTimer) {
                    clearInterval(this.callTimer);
                    this.callTimer = null;
                }
            }
            
            toggleMute() {
                this.isMuted = !this.isMuted;
                const muteBtn = document.getElementById('muteBtn');
                if (this.isMuted) {
                    muteBtn.innerHTML = '<i class="fas fa-microphone-slash"></i>';
                    this.showToast('ÿ™ŸÖ ŸÉÿ™ŸÖ ÿßŸÑÿµŸàÿ™', 'info');
                } else {
                    muteBtn.innerHTML = '<i class="fas fa-microphone"></i>';
                    this.showToast('ÿ™ŸÖ ÿ•ŸÑÿ∫ÿßÿ° ŸÉÿ™ŸÖ ÿßŸÑÿµŸàÿ™', 'info');
                }
            }
            
            toggleSpeaker() {
                this.isSpeaker = !this.isSpeaker;
                const speakerBtn = document.getElementById('speakerBtn');
                if (this.isSpeaker) {
                    speakerBtn.innerHTML = '<i class="fas fa-volume-up"></i>';
                    this.showToast('ŸÖŸÉÿ®ÿ± ÿßŸÑÿµŸàÿ™ ŸÖŸÅÿπŸÑ', 'info');
                } else {
                    speakerBtn.innerHTML = '<i class="fas fa-volume-down"></i>';
                    this.showToast('ŸÖŸÉÿ®ÿ± ÿßŸÑÿµŸàÿ™ ŸÖÿπÿ∑ŸÑ', 'info');
                }
            }
            
            toggleTheme() {
                this.darkMode = !this.darkMode;
                this.settings.darkMode = this.darkMode;
                
                if (this.darkMode) {
                    document.body.classList.add('dark-mode');
                    document.querySelector('#themeToggle i').classList.remove('fa-moon');
                    document.querySelector('#themeToggle i').classList.add('fa-sun');
                    this.showToast('ÿßŸÑŸàÿ∂ÿπ ÿßŸÑÿØÿßŸÉŸÜ ŸÖŸÅÿπŸÑ', 'info');
                } else {
                    document.body.classList.remove('dark-mode');
                    document.querySelector('#themeToggle i').classList.remove('fa-sun');
                    document.querySelector('#themeToggle i').classList.add('fa-moon');
                    this.showToast('ÿßŸÑŸàÿ∂ÿπ ÿßŸÑŸÅÿßÿ™ÿ≠ ŸÖŸÅÿπŸÑ', 'info');
                }
                
                this.saveData();
            }
            
            loadCallsScreen() {
                const contentArea = document.getElementById('contentArea');
                let html = '<div class="calls-list">';
                
                this.calls.forEach(call => {
                    const user = this.users.find(u => u.id === call.userId);
                    if (!user) return;
                    
                    const callTypeClass = call.type === 'incoming' ? 
                        (call.status === 'missed' ? 'missed' : 'incoming') : 'outgoing';
                    
                    const callIcon = call.type === 'incoming' ? 
                        (call.status === 'missed' ? 'fa-phone-slash' : 'fa-phone') : 'fa-phone';
                    
                    const duration = call.duration > 0 ? this.formatDuration(call.duration) : '';
                    
                    html += `
                        <div class="call-item">
                            <div class="call-avatar">
                                <img src="${user.avatar}" alt="${user.name}" class="call-img">
                            </div>
                            
                            <div class="call-info">
                                <div class="call-header">
                                    <div class="call-name">${user.name}</div>
                                    <div class="call-time">${call.time}</div>
                                </div>
                                
                                <div class="call-details">
                                    <div class="call-type ${callTypeClass}">
                                        <i class="fas ${callIcon}"></i>
                                        <span>${call.type === 'incoming' ? 'Ÿàÿßÿ±ÿØ' : 'ÿµÿßÿØÿ±'}</span>
                                    </div>
                                    <span>${duration}</span>
                                </div>
                            </div>
                            
                            <div class="call-actions">
                                <div class="header-icon" onclick="ronApp.startCallWithUser(${user.id})">
                                    <i class="fas fa-phone"></i>
                                </div>
                                <div class="header-icon" onclick="ronApp.openChatWithUser(${user.id})">
                                    <i class="fas fa-comment"></i>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                html += '</div>';
                contentArea.innerHTML = html;
            }
            
            loadContactsScreen() {
                const contentArea = document.getElementById('contentArea');
                let html = '<div class="contacts-container">';
                
                this.contacts.forEach(contact => {
                    const user = this.users.find(u => u.id === contact.id);
                    if (!user) return;
                    
                    const onlineStatus = user.online ? 'ŸÖÿ™ÿµŸÑ ÿßŸÑÿ¢ŸÜ' : 'ÿ∫Ÿäÿ± ŸÖÿ™ÿµŸÑ';
                    
                    html += `
                        <div class="contact-item" onclick="ronApp.openChatWithUser(${user.id})">
                            <div class="contact-avatar">
                                <img src="${user.avatar}" alt="${user.name}" class="contact-img">
                            </div>
                            
                            <div class="contact-info">
                                <div class="contact-name">${user.name}</div>
                                <div class="contact-status">${onlineStatus}</div>
                            </div>
                        </div>
                    `;
                });
                
                html += '</div>';
                contentArea.innerHTML = html;
            }
            
            loadContacts() {
                const contactsList = document.getElementById('contactsList');
                let html = '';
                
                this.contacts.forEach(contact => {
                    const user = this.users.find(u => u.id === contact.id);
                    if (!user || user.id === this.currentUser.id) return;
                    
                    const existingChat = this.chats.find(c => c.userId === user.id);
                    
                    html += `
                        <div class="contact-item" onclick="ronApp.${existingChat ? 'openChatWithUser' : 'startNewChat'}(${user.id})">
                            <div class="contact-avatar">
                                <img src="${user.avatar}" alt="${user.name}" class="contact-img">
                            </div>
                            
                            <div class="contact-info">
                                <div class="contact-name">${user.name}</div>
                                <div class="contact-status">${user.bio}</div>
                            </div>
                        </div>
                    `;
                });
                
                contactsList.innerHTML = html;
            }
            
            searchContacts(query) {
                const contacts = document.querySelectorAll('.contact-item');
                contacts.forEach(contact => {
                    const name = contact.querySelector('.contact-name').textContent.toLowerCase();
                    if (name.includes(query.toLowerCase())) {
                        contact.style.display = 'flex';
                    } else {
                        contact.style.display = 'none';
                    }
                });
            }
            
            openChatWithUser(userId) {
                // ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ÿØÿ±ÿØÿ¥ÿ© ŸÖŸàÿ¨ŸàÿØÿ©
                const existingChat = this.chats.find(c => c.userId === userId);
                
                if (existingChat) {
                    this.openChat(existingChat.id, userId);
                } else {
                    this.startNewChat(userId);
                }
            }
            
            startNewChat(userId) {
                const user = this.users.find(u => u.id === userId);
                if (!user) return;
                
                // ÿ•ŸÜÿ¥ÿßÿ° ÿØÿ±ÿØÿ¥ÿ© ÿ¨ÿØŸäÿØÿ©
                const newChat = {
                    id: this.chats.length + 1,
                    userId: userId,
                    lastMessage: 'ÿ®ÿØÿ£ÿ™ ŸÖÿ≠ÿßÿØÿ´ÿ© ÿ¨ÿØŸäÿØÿ©',
                    time: 'ÿßŸÑÿ¢ŸÜ',
                    unread: 0,
                    lastMessageTime: Date.now(),
                    pinned: false
                };
                
                this.chats.push(newChat);
                this.saveData();
                
                // ŸÅÿ™ÿ≠ ÿßŸÑÿØÿ±ÿØÿ¥ÿ©
                this.openChat(newChat.id, userId);
                
                // ÿßŸÑÿπŸàÿØÿ© ŸÑŸÑÿ¥ÿßÿ¥ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
                this.showMainScreen();
                this.navigateTo('chats');
            }
            
            startCallWithUser(userId) {
                const user = this.users.find(u => u.id === userId);
                if (!user) return;
                
                // ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ÿØÿ±ÿØÿ¥ÿ© ŸÖŸàÿ¨ŸàÿØÿ© ÿ£Ÿà ÿ•ŸÜÿ¥ÿßÿ° ÿ¨ÿØŸäÿØÿ©
                let chat = this.chats.find(c => c.userId === userId);
                if (!chat) {
                    chat = {
                        id: this.chats.length + 1,
                        userId: userId,
                        lastMessage: 'ÿ®ÿØÿ£ÿ™ ŸÖÿ≠ÿßÿØÿ´ÿ© ÿ¨ÿØŸäÿØÿ©',
                        time: 'ÿßŸÑÿ¢ŸÜ',
                        unread: 0,
                        lastMessageTime: Date.now(),
                        pinned: false
                    };
                    this.chats.push(chat);
                }
                
                this.currentChat = { id: chat.id, userId: userId };
                this.startAudioCall();
            }
            
            loadStatusScreen() {
                const contentArea = document.getElementById('contentArea');
                
                const now = new Date();
                const time = `${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')}`;
                
                html = `
                    <div class="status-container">
                        <div class="my-status" onclick="ronApp.showNewStoryModal()">
                            <div class="status-avatar">
                                <img src="${this.currentUser.avatar}" class="status-img">
                                <div class="add-status">
                                    <i class="fas fa-plus"></i>
                                </div>
                            </div>
                            <div class="status-info">
                                <div class="status-title">ÿ≠ÿßŸÑÿ™Ÿä</div>
                                <div class="status-subtitle">ÿßŸÜŸÇÿ± ŸÑÿ•ÿ∂ÿßŸÅÿ© ÿ™ÿ≠ÿØŸäÿ´ ŸÑÿ≠ÿßŸÑÿ™ŸÉ</div>
                            </div>
                        </div>
                        
                        <div class="recent-statuses">
                            <div class="section-title">ÿßŸÑÿ™ÿ≠ÿØŸäÿ´ÿßÿ™ ÿßŸÑÿ£ÿÆŸäÿ±ÿ©</div>
                `;
                
                this.stories.forEach(story => {
                    const user = this.users.find(u => u.id === story.userId);
                    if (user && user.id !== this.currentUser.id) {
                        const timeAgo = this.getTimeAgo(story.timestamp);
                        html += `
                            <div class="contact-item" onclick="ronApp.viewStory(${story.id})">
                                <div class="contact-avatar">
                                    <img src="${user.avatar}" alt="${user.name}" class="contact-img">
                                </div>
                                
                                <div class="contact-info">
                                    <div class="contact-name">${user.name}</div>
                                    <div class="contact-status">${timeAgo}</div>
                                </div>
                            </div>
                        `;
                    }
                });
                
                html += `
                        </div>
                    </div>
                `;
                
                contentArea.innerHTML = html;
            }
            
            loadSettingsScreen() {
                const contentArea = document.getElementById('contentArea');
                
                html = `
                    <div class="settings-container">
                        <div class="settings-item" onclick="ronApp.showEditProfileModal()">
                            <div class="settings-icon">
                                <i class="fas fa-user-edit"></i>
                            </div>
                            <div class="settings-content">
                                <div class="settings-title">ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä</div>
                                <div class="settings-subtitle">ÿ™ÿπÿØŸäŸÑ ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿ≠ÿ≥ÿßÿ®ŸÉ</div>
                            </div>
                        </div>
                        
                        <div class="settings-item" onclick="ronApp.showNotificationsSettings()">
                            <div class="settings-icon">
                                <i class="fas fa-bell"></i>
                            </div>
                            <div class="settings-content">
                                <div class="settings-title">ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™</div>
                                <div class="settings-subtitle">ÿ•ÿØÿßÿ±ÿ© ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ</div>
                            </div>
                        </div>
                        
                        <div class="settings-item" onclick="ronApp.showPrivacySettings()">
                            <div class="settings-icon">
                                <i class="fas fa-lock"></i>
                            </div>
                            <div class="settings-content">
                                <div class="settings-title">ÿßŸÑÿÆÿµŸàÿµŸäÿ© ŸàÿßŸÑÿ£ŸÖÿßŸÜ</div>
                                <div class="settings-subtitle">ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿÆÿµŸàÿµŸäÿ© ŸàÿßŸÑÿ£ŸÖÿßŸÜ</div>
                            </div>
                        </div>
                        
                        <div class="settings-item">
                            <div class="settings-icon">
                                <i class="fas fa-palette"></i>
                            </div>
                            <div class="settings-content">
                                <div class="settings-title">ÿßŸÑŸÖÿ∏Ÿáÿ±</div>
                                <div class="settings-subtitle">${this.darkMode ? 'ÿßŸÑŸàÿ∂ÿπ ÿßŸÑÿØÿßŸÉŸÜ' : 'ÿßŸÑŸàÿ∂ÿπ ÿßŸÑŸÅÿßÿ™ÿ≠'}</div>
                            </div>
                            <div class="toggle-switch">
                                <input type="checkbox" ${this.darkMode ? 'checked' : ''} onchange="ronApp.toggleTheme()">
                                <span class="toggle-slider"></span>
                            </div>
                        </div>
                        
                        <div class="settings-item" onclick="ronApp.showHelpCenter()">
                            <div class="settings-icon">
                                <i class="fas fa-question-circle"></i>
                            </div>
                            <div class="settings-content">
                                <div class="settings-title">ŸÖÿ±ŸÉÿ≤ ÿßŸÑŸÖÿ≥ÿßÿπÿØÿ©</div>
                                <div class="settings-subtitle">ÿßŸÑÿØÿπŸÖ ŸàÿßŸÑŸÖÿ≥ÿßÿπÿØÿ©</div>
                            </div>
                        </div>
                        
                        <div class="settings-item" onclick="ronApp.showAboutApp()">
                            <div class="settings-icon">
                                <i class="fas fa-info-circle"></i>
                            </div>
                            <div class="settings-content">
                                <div class="settings-title">ÿπŸÜ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ</div>
                                <div class="settings-subtitle">ÿ•ÿµÿØÿßÿ± 1.0.0</div>
                            </div>
                        </div>
                    </div>
                `;
                
                contentArea.innerHTML = html;
            }
            
            showEditProfileModal() {
                this.showModal(
                    'ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä',
                    `
                    <div class="input-group">
                        <label class="input-label">ÿßŸÑÿßÿ≥ŸÖ ÿßŸÑŸÉÿßŸÖŸÑ</label>
                        <input type="text" id="editProfileName" value="${this.currentUser.name}">
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä</label>
                        <input type="email" id="editProfileEmail" value="${this.currentUser.email}">
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">ÿ≠ÿßŸÑÿ© ÿßŸÑÿ≠ÿ≥ÿßÿ®</label>
                        <input type="text" id="editProfileStatus" value="${this.currentUser.status}">
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">ÿßŸÑÿ≥Ÿäÿ±ÿ© ÿßŸÑÿ∞ÿßÿ™Ÿäÿ©</label>
                        <textarea id="editProfileBio" rows="3">${this.currentUser.bio}</textarea>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ</label>
                        <input type="text" id="editProfilePhone" value="${this.currentUser.phone}">
                    </div>
                    
                    <button class="btn-primary" onclick="ronApp.saveProfile()">ÿ≠ŸÅÿ∏ ÿßŸÑÿ™ÿ∫ŸäŸäÿ±ÿßÿ™</button>
                    `
                );
            }
            
            saveProfile() {
                const name = document.getElementById('editProfileName').value.trim();
                const email = document.getElementById('editProfileEmail').value.trim();
                const status = document.getElementById('editProfileStatus').value.trim();
                const bio = document.getElementById('editProfileBio').value.trim();
                const phone = document.getElementById('editProfilePhone').value.trim();
                
                if (!name || !email) {
                    this.showToast('ÿßŸÑÿßÿ≥ŸÖ ŸàÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä ŸÖÿ∑ŸÑŸàÿ®ÿßŸÜ', 'error');
                    return;
                }
                
                // ÿ™ÿ≠ÿØŸäÿ´ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ
                this.currentUser.name = name;
                this.currentUser.email = email;
                this.currentUser.status = status;
                this.currentUser.bio = bio;
                this.currentUser.phone = phone;
                
                // ÿ™ÿ≠ÿØŸäÿ´ ŸÅŸä ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿπÿßŸÖÿ©
                const userIndex = this.users.findIndex(u => u.id === this.currentUser.id);
                if (userIndex !== -1) {
                    this.users[userIndex] = this.currentUser;
                }
                
                // ÿ≠ŸÅÿ∏ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
                localStorage.setItem('ron_currentUser', JSON.stringify(this.currentUser));
                this.saveData();
                
                // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸàÿßÿ¨Ÿáÿ©
                document.getElementById('profileName').textContent = name;
                document.getElementById('profileStatus').textContent = status;
                document.getElementById('headerProfileImg').src = this.currentUser.avatar;
                
                this.hideModal();
                this.showToast('ÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿßŸÑÿ™ÿ∫ŸäŸäÿ±ÿßÿ™ ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
            }
            
            showNotificationsSettings() {
                this.showModal(
                    'ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™',
                    `
                    <div class="settings-item">
                        <div class="settings-content">
                            <div class="settings-title">ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿßŸÑÿØÿ±ÿØÿ¥ÿßÿ™</div>
                            <div class="settings-subtitle">ÿ™ŸÑŸÇŸä ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿπŸÜÿØ ŸàÿµŸàŸÑ ÿ±ÿ≥ÿßÿ¶ŸÑ ÿ¨ÿØŸäÿØÿ©</div>
                        </div>
                        <div class="toggle-switch">
                            <input type="checkbox" ${this.settings.notifications ? 'checked' : ''} id="notificationsToggle">
                            <span class="toggle-slider"></span>
                        </div>
                    </div>
                    
                    <div class="settings-item">
                        <div class="settings-content">
                            <div class="settings-title">ÿßŸÑÿ£ÿµŸàÿßÿ™</div>
                            <div class="settings-subtitle">ÿ™ÿ¥ÿ∫ŸäŸÑ ÿ£ÿµŸàÿßÿ™ ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™</div>
                        </div>
                        <div class="toggle-switch">
                            <input type="checkbox" ${this.settings.sound ? 'checked' : ''} id="soundToggle">
                            <span class="toggle-slider"></span>
                        </div>
                    </div>
                    
                    <div class="settings-item">
                        <div class="settings-content">
                            <div class="settings-title">ÿßŸÑÿßŸáÿ™ÿ≤ÿßÿ≤</div>
                            <div class="settings-subtitle">ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿßŸáÿ™ÿ≤ÿßÿ≤ ÿπŸÜÿØ ŸàÿµŸàŸÑ ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™</div>
                        </div>
                        <div class="toggle-switch">
                            <input type="checkbox" ${this.settings.vibration ? 'checked' : ''} id="vibrationToggle">
                            <span class="toggle-slider"></span>
                        </div>
                    </div>
                    
                    <button class="btn-primary" onclick="ronApp.saveNotificationSettings()">ÿ≠ŸÅÿ∏ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™</button>
                    `
                );
            }
            
            saveNotificationSettings() {
                this.settings.notifications = document.getElementById('notificationsToggle').checked;
                this.settings.sound = document.getElementById('soundToggle').checked;
                this.settings.vibration = document.getElementById('vibrationToggle').checked;
                
                this.saveData();
                this.hideModal();
                this.showToast('ÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™', 'success');
            }
            
            showPrivacySettings() {
                this.showModal(
                    'ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿÆÿµŸàÿµŸäÿ©',
                    `
                    <div class="input-group">
                        <label class="input-label">ÿ¢ÿÆÿ± ÿ∏ŸáŸàÿ±</label>
                        <select id="lastSeenPrivacy">
                            <option value="everyone" ${this.settings.privacy.lastSeen === 'everyone' ? 'selected' : ''}>ÿßŸÑÿ¨ŸÖŸäÿπ</option>
                            <option value="contacts" ${this.settings.privacy.lastSeen === 'contacts' ? 'selected' : ''}>ÿ¨Ÿáÿßÿ™ ÿßŸÑÿßÿ™ÿµÿßŸÑ ŸÅŸÇÿ∑</option>
                            <option value="nobody" ${this.settings.privacy.lastSeen === 'nobody' ? 'selected' : ''}>ŸÑÿß ÿ£ÿ≠ÿØ</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">ÿµŸàÿ±ÿ© ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä</label>
                        <select id="profilePhotoPrivacy">
                            <option value="everyone" ${this.settings.privacy.profilePhoto === 'everyone' ? 'selected' : ''}>ÿßŸÑÿ¨ŸÖŸäÿπ</option>
                            <option value="contacts" ${this.settings.privacy.profilePhoto === 'contacts' ? 'selected' : ''}>ÿ¨Ÿáÿßÿ™ ÿßŸÑÿßÿ™ÿµÿßŸÑ ŸÅŸÇÿ∑</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">ÿßŸÑÿ≠ÿßŸÑÿ©</label>
                        <select id="statusPrivacy">
                            <option value="everyone" ${this.settings.privacy.status === 'everyone' ? 'selected' : ''}>ÿßŸÑÿ¨ŸÖŸäÿπ</option>
                            <option value="contacts" ${this.settings.privacy.status === 'contacts' ? 'selected' : ''}>ÿ¨Ÿáÿßÿ™ ÿßŸÑÿßÿ™ÿµÿßŸÑ ŸÅŸÇÿ∑</option>
                        </select>
                    </div>
                    
                    <button class="btn-primary" onclick="ronApp.savePrivacySettings()">ÿ≠ŸÅÿ∏ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™</button>
                    `
                );
            }
            
            savePrivacySettings() {
                this.settings.privacy = {
                    lastSeen: document.getElementById('lastSeenPrivacy').value,
                    profilePhoto: document.getElementById('profilePhotoPrivacy').value,
                    status: document.getElementById('statusPrivacy').value
                };
                
                this.saveData();
                this.hideModal();
                this.showToast('ÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿÆÿµŸàÿµŸäÿ©', 'success');
            }
            
            showThemeSettings() {
                this.showModal(
                    'ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖÿ∏Ÿáÿ±',
                    `
                    <div class="story-options">
                        <div class="story-option" onclick="ronApp.changeTheme('default')">
                            <div class="story-option-icon">
                                <i class="fas fa-sun"></i>
                            </div>
                            <div class="story-name">ŸÅÿßÿ™ÿ≠</div>
                        </div>
                        
                        <div class="story-option" onclick="ronApp.changeTheme('dark')">
                            <div class="story-option-icon">
                                <i class="fas fa-moon"></i>
                            </div>
                            <div class="story-name">ÿØÿßŸÉŸÜ</div>
                        </div>
                    </div>
                    `
                );
            }
            
            changeTheme(theme) {
                if (theme === 'dark' && !this.darkMode) {
                    this.toggleTheme();
                } else if (theme === 'default' && this.darkMode) {
                    this.toggleTheme();
                }
                this.hideModal();
            }
            
            showHelpCenter() {
                this.showModal(
                    'ŸÖÿ±ŸÉÿ≤ ÿßŸÑŸÖÿ≥ÿßÿπÿØÿ©',
                    `
                    <div style="margin-bottom: 20px;">
                        <h3>ŸÉŸäŸÅŸäÿ© ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ</h3>
                        <p>1. ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ: ÿßŸÅÿ™ÿ≠ ÿØÿ±ÿØÿ¥ÿ© ŸàÿßŸÉÿ™ÿ® ÿ±ÿ≥ÿßŸÑÿ™ŸÉ ŸÅŸä ÿßŸÑÿ≠ŸÇŸÑ ÿßŸÑÿ£ÿ≥ŸÅŸÑ</p>
                        <p>2. ÿßŸÑŸÖŸÉÿßŸÑŸÖÿßÿ™: ÿßŸÜŸÇÿ± ÿπŸÑŸâ ÿ£ŸäŸÇŸàŸÜÿ© ÿßŸÑŸáÿßÿ™ŸÅ ŸÑŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿ£ÿ≠ÿØ ÿ¨Ÿáÿßÿ™ ÿßŸÑÿßÿ™ÿµÿßŸÑ</p>
                        <p>3. ÿßŸÑÿ≠ÿßŸÑÿ©: ŸäŸÖŸÉŸÜŸÉ ÿ•ÿ∂ÿßŸÅÿ© ŸÇÿµÿ© ŸÖŸÜ ÿ¥ÿßÿ¥ÿ© ÿßŸÑÿ≠ÿßŸÑÿ©</p>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <h3>ÿßŸÑÿØÿπŸÖ ÿßŸÑŸÅŸÜŸä</h3>
                        <p>ŸÑŸÑÿ•ÿ®ŸÑÿßÿ∫ ÿπŸÜ ŸÖÿ¥ŸÉŸÑÿ© ÿ£Ÿà ÿßŸÑÿßÿ≥ÿ™ŸÅÿ≥ÿßÿ±:</p>
                        <p>ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä: support@ronapp.com</p>
                        <p>ÿßŸÑŸáÿßÿ™ŸÅ: 920000000</p>
                    </div>
                    
                    <button class="btn-secondary" onclick="ronApp.hideModal()">ÿ•ÿ∫ŸÑÿßŸÇ</button>
                    `
                );
            }
            
            showAboutApp() {
                this.showModal(
                    'ÿπŸÜ ÿ™ÿ∑ÿ®ŸäŸÇ ÿ±ŸàŸÜ',
                    `
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div style="font-size: 48px; font-weight: bold; color: var(--primary-color); margin-bottom: 10px;">ÿ±ŸàŸÜ</div>
                        <p>ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑŸÖÿ±ÿßÿ≥ŸÑÿ© ÿßŸÑŸÖÿ±ŸÉÿ≤Ÿä</p>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <p><strong>ÿßŸÑÿ•ÿµÿØÿßÿ±:</strong> 1.0.0</p>
                        <p><strong>ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ•ÿµÿØÿßÿ±:</strong> 2024</p>
                        <p><strong>ÿßŸÑŸÖÿ∑Ÿàÿ±:</strong> ŸÅÿ±ŸäŸÇ ÿ±ŸàŸÜ</p>
                    </div>
                    
                    <p>ÿ™ÿ∑ÿ®ŸäŸÇ ÿ±ŸàŸÜ ŸáŸà ÿ™ÿ∑ÿ®ŸäŸÇ ŸÖÿ±ÿßÿ≥ŸÑÿ© ÿ¥ÿßŸÖŸÑ Ÿäÿ™Ÿäÿ≠ ŸÑŸÉ ÿßŸÑÿ™ŸàÿßÿµŸÑ ŸÖÿπ ÿ£ÿµÿØŸÇÿßÿ¶ŸÉ Ÿàÿπÿßÿ¶ŸÑÿ™ŸÉ ÿπÿ®ÿ± ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑŸÜÿµŸäÿ© ŸàÿßŸÑŸÖŸÉÿßŸÑŸÖÿßÿ™ ÿßŸÑÿµŸàÿ™Ÿäÿ©.</p>
                    
                    <button class="btn-secondary" onclick="ronApp.hideModal()">ÿ•ÿ∫ŸÑÿßŸÇ</button>
                    `
                );
            }
            
            showNewStoryModal() {
                this.showModal(
                    'ÿ•ÿ∂ÿßŸÅÿ© ŸÇÿµÿ© ÿ¨ÿØŸäÿØÿ©',
                    `
                    <div class="new-story-container">
                        <div class="story-camera">
                            <i class="fas fa-camera"></i>
                        </div>
                        
                        <p>ÿßŸÑÿ™ŸÇÿ∑ ÿµŸàÿ±ÿ© ÿ£Ÿà ÿ≥ÿ¨ŸÑ ŸÅŸäÿØŸäŸà ŸÑŸÖÿ¥ÿßÿ±ŸÉÿ™Ÿá ŸÉŸÇÿµÿ©</p>
                        
                        <div class="story-options">
                            <div class="story-option" onclick="ronApp.takePhoto()">
                                <div class="story-option-icon">
                                    <i class="fas fa-camera"></i>
                                </div>
                                <div class="story-name">ÿßŸÑÿ™ŸÇÿ∑ ÿµŸàÿ±ÿ©</div>
                            </div>
                            
                            <div class="story-option" onclick="ronApp.recordVideo()">
                                <div class="story-option-icon">
                                    <i class="fas fa-video"></i>
                                </div>
                                <div class="story-name">ÿ≥ÿ¨ŸÑ ŸÅŸäÿØŸäŸà</div>
                            </div>
                        </div>
                    </div>
                    `
                );
            }
            
            takePhoto() {
                this.showToast('ŸÅÿ™ÿ≠ ÿßŸÑŸÉÿßŸÖŸäÿ±ÿß...', 'info');
                this.hideModal();
                // ŸÅŸä ÿ™ÿ∑ÿ®ŸäŸÇ ÿ≠ŸÇŸäŸÇŸäÿå ŸáŸÜÿß ÿ≥Ÿäÿ™ŸÖ ŸÅÿ™ÿ≠ Ÿàÿßÿ¨Ÿáÿ© ÿßŸÑŸÉÿßŸÖŸäÿ±ÿß
            }
            
            recordVideo() {
                this.showToast('ŸÅÿ™ÿ≠ ŸÉÿßŸÖŸäÿ±ÿß ÿßŸÑŸÅŸäÿØŸäŸà...', 'info');
                this.hideModal();
                // ŸÅŸä ÿ™ÿ∑ÿ®ŸäŸÇ ÿ≠ŸÇŸäŸÇŸäÿå ŸáŸÜÿß ÿ≥Ÿäÿ™ŸÖ ŸÅÿ™ÿ≠ Ÿàÿßÿ¨Ÿáÿ© ŸÉÿßŸÖŸäÿ±ÿß ÿßŸÑŸÅŸäÿØŸäŸà
            }
            
            viewStory(storyId) {
                const story = this.stories.find(s => s.id === storyId);
                if (story) {
                    story.seen = true;
                    this.saveData();
                    this.showToast('ÿπÿ±ÿ∂ ÿßŸÑŸÇÿµÿ©...', 'info');
                }
            }
            
            showAttachMenu() {
                this.showModal(
                    'ÿ•ÿ±ŸÅÿßŸÇ ŸÖŸÑŸÅ',
                    `
                    <div class="story-options">
                        <div class="story-option" onclick="ronApp.attachPhoto()">
                            <div class="story-option-icon">
                                <i class="fas fa-image"></i>
                            </div>
                            <div class="story-name">ÿµŸàÿ±ÿ©</div>
                        </div>
                        
                        <div class="story-option" onclick="ronApp.attachVideo()">
                            <div class="story-option-icon">
                                <i class="fas fa-video"></i>
                            </div>
                            <div class="story-name">ŸÅŸäÿØŸäŸà</div>
                        </div>
                        
                        <div class="story-option" onclick="ronApp.attachDocument()">
                            <div class="story-option-icon">
                                <i class="fas fa-file"></i>
                            </div>
                            <div class="story-name">ŸÖŸÑŸÅ</div>
                        </div>
                        
                        <div class="story-option" onclick="ronApp.attachLocation()">
                            <div class="story-option-icon">
                                <i class="fas fa-map-marker-alt"></i>
                            </div>
                            <div class="story-name">ŸÖŸàŸÇÿπ</div>
                        </div>
                    </div>
                    `
                );
            }
            
            attachPhoto() {
                this.showToast('ŸÅÿ™ÿ≠ ŸÖÿπÿ±ÿ∂ ÿßŸÑÿµŸàÿ±...', 'info');
                this.hideModal();
            }
            
            attachVideo() {
                this.showToast('ŸÅÿ™ÿ≠ ŸÖÿπÿ±ÿ∂ ÿßŸÑŸÅŸäÿØŸäŸà...', 'info');
                this.hideModal();
            }
            
            attachDocument() {
                this.showToast('ŸÅÿ™ÿ≠ ŸÖÿØŸäÿ± ÿßŸÑŸÖŸÑŸÅÿßÿ™...', 'info');
                this.hideModal();
            }
            
            attachLocation() {
                this.showToast('ŸÅÿ™ÿ≠ ÿßŸÑÿÆÿ±Ÿäÿ∑ÿ©...', 'info');
                this.hideModal();
            }
            
            openCamera() {
                this.showToast('ŸÅÿ™ÿ≠ ÿßŸÑŸÉÿßŸÖŸäÿ±ÿß...', 'info');
            }
            
            showChatMenu() {
                this.showModal(
                    'ÿÆŸäÿßÿ±ÿßÿ™ ÿßŸÑÿØÿ±ÿØÿ¥ÿ©',
                    `
                    <div class="info-item" onclick="ronApp.clearChat()">
                        <div class="info-icon">
                            <i class="fas fa-trash"></i>
                        </div>
                        <div class="info-content">
                            <div class="info-title">ŸÖÿ≥ÿ≠ ÿßŸÑÿØÿ±ÿØÿ¥ÿ©</div>
                            <div class="info-subtitle">ÿ≠ÿ∞ŸÅ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ</div>
                        </div>
                    </div>
                    
                    <div class="info-item" onclick="ronApp.blockUser()">
                        <div class="info-icon">
                            <i class="fas fa-ban"></i>
                        </div>
                        <div class="info-content">
                            <div class="info-title">ÿ≠ÿ∏ÿ± ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ</div>
                            <div class="info-subtitle">ŸÖŸÜÿπ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÖŸÜ ÿßŸÑÿ™ŸàÿßÿµŸÑ ŸÖÿπŸÉ</div>
                        </div>
                    </div>
                    
                    <div class="info-item" onclick="ronApp.reportUser()">
                        <div class="info-icon">
                            <i class="fas fa-flag"></i>
                        </div>
                        <div class="info-content">
                            <div class="info-title">ÿßŸÑÿ•ÿ®ŸÑÿßÿ∫ ÿπŸÜ ŸÖÿ≥ÿ™ÿÆÿØŸÖ</div>
                            <div class="info-subtitle">ÿßŸÑÿ•ÿ®ŸÑÿßÿ∫ ÿπŸÜ ÿ≥ŸÑŸàŸÉ ÿ∫Ÿäÿ± ŸÑÿßÿ¶ŸÇ</div>
                        </div>
                    </div>
                    `
                );
            }
            
            clearChat() {
                if (this.currentChat && confirm('ŸáŸÑ ÿ™ÿ±ŸäÿØ ŸÖÿ≥ÿ≠ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ŸÅŸä Ÿáÿ∞Ÿá ÿßŸÑÿØÿ±ÿØÿ¥ÿ©ÿü')) {
                    this.messages[this.currentChat.id] = [];
                    this.saveData();
                    this.loadMessages(this.currentChat.id);
                    this.hideModal();
                    this.showToast('ÿ™ŸÖ ŸÖÿ≥ÿ≠ ÿßŸÑÿØÿ±ÿØÿ¥ÿ©', 'success');
                }
            }
            
            blockUser() {
                if (this.currentChat && confirm('ŸáŸÑ ÿ™ÿ±ŸäÿØ ÿ≠ÿ∏ÿ± Ÿáÿ∞ÿß ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖÿü')) {
                    this.showToast('ÿ™ŸÖ ÿ≠ÿ∏ÿ± ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ', 'success');
                    this.hideModal();
                }
            }
            
            reportUser() {
                if (this.currentChat) {
                    this.showToast('ÿ™ŸÖ ÿßŸÑÿ•ÿ®ŸÑÿßÿ∫ ÿπŸÜ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ', 'success');
                    this.hideModal();
                }
            }
            
            showSearch() {
                this.showModal(
                    'ÿ®ÿ≠ÿ´',
                    `
                    <div class="input-group">
                        <input type="text" id="globalSearch" placeholder="ÿßÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑÿØÿ±ÿØÿ¥ÿßÿ™ ŸàÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ...">
                        <div class="input-icon">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <p>ÿ£ÿØÿÆŸÑ ŸÉŸÑŸÖÿ© ŸÑŸÑÿ®ÿ≠ÿ´ ŸÅŸä:</p>
                        <ul style="padding-right: 20px; color: var(--text-secondary);">
                            <li>ÿßŸÑÿØÿ±ÿØÿ¥ÿßÿ™</li>
                            <li>ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ</li>
                            <li>ÿ¨Ÿáÿßÿ™ ÿßŸÑÿßÿ™ÿµÿßŸÑ</li>
                        </ul>
                    </div>
                    `
                );
            }
            
            showModal(title, content) {
                const modal = document.getElementById('modal');
                modal.innerHTML = `
                    <div class="modal-header">
                        <div class="modal-title">${title}</div>
                        <div class="modal-close" onclick="ronApp.hideModal()">
                            <i class="fas fa-times"></i>
                        </div>
                    </div>
                    <div class="modal-body">${content}</div>
                `;
                
                document.getElementById('modalOverlay').classList.add('active');
            }
            
            hideModal() {
                document.getElementById('modalOverlay').classList.remove('active');
            }
            
            showToast(message, type = 'info') {
                const backgroundColor = type === 'success' ? '#00c851' : 
                                     type === 'error' ? '#ff4444' : 
                                     type === 'warning' ? '#ffbb33' : '#0084ff';
                
                Toastify({
                    text: message,
                    duration: 3000,
                    gravity: "top",
                    position: "left",
                    backgroundColor: backgroundColor,
                    stopOnFocus: true
                }).showToast();
            }
            
            formatDuration(seconds) {
                const minutes = Math.floor(seconds / 60);
                const remainingSeconds = seconds % 60;
                return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;
            }
            
            formatCallTime(timestamp) {
                const now = Date.now();
                const diff = now - timestamp;
                
                if (diff < 60000) return 'ÿßŸÑÿ¢ŸÜ';
                if (diff < 3600000) return `${Math.floor(diff / 60000)} ÿØŸÇŸäŸÇÿ©`;
                if (diff < 86400000) return `${Math.floor(diff / 3600000)} ÿ≥ÿßÿπÿ©`;
                if (diff < 604800000) return `${Math.floor(diff / 86400000)} ŸäŸàŸÖ`;
                
                const date = new Date(timestamp);
                return `${date.getDate()}/${date.getMonth() + 1}`;
            }
            
            getTimeAgo(timestamp) {
                const now = Date.now();
                const diff = now - timestamp;
                
                if (diff < 60000) return 'ÿßŸÑÿ¢ŸÜ';
                if (diff < 3600000) return `ŸÇÿ®ŸÑ ${Math.floor(diff / 60000)} ÿØŸÇŸäŸÇÿ©`;
                if (diff < 86400000) return `ŸÇÿ®ŸÑ ${Math.floor(diff / 3600000)} ÿ≥ÿßÿπÿ©`;
                if (diff < 604800000) return `ŸÇÿ®ŸÑ ${Math.floor(diff / 86400000)} ŸäŸàŸÖ`;
                
                return `ŸÇÿ®ŸÑ ${Math.floor(diff / 604800000)} ÿ£ÿ≥ÿ®Ÿàÿπ`;
            }
        }
        
        // ÿ™ŸáŸäÿ¶ÿ© ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ
        let ronApp;
        document.addEventListener('DOMContentLoaded', () => {
            ronApp = new RonApp();
            
            // ÿ¨ÿπŸÑ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ŸÖÿ™ÿßÿ≠ÿßŸã ÿ®ÿ¥ŸÉŸÑ ÿπÿßŸÖ
            window.ronApp = ronApp;
        });
    </script>
</body>
</html>
